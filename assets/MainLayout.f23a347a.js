import{h as M,c as K,a as b,d as Te,P as pa,e as ha,f as He,n as Rr,l as va,g as Ie,p as rr,i as It,s as nr,j as Bt,k as Ge,m as Wt,u as Er,o as ht,q as Or,r as vt,t as Dr,v as me,w as A,x as Mr,y as ma,z as j,A as we,B as Le,C as de,D as hr,E as Vr,F as Kt,G as se,H as ga,I as mt,J as Nn,K as ya,L as Ar,M as Ne,N as Ir,O as Qt,Q as kt,R as ba,S as Pt,T as rt,U as _a,V as Ca,W as Sa,X as Un,Y as Hn,Z as Br,_ as bt,$ as ct,a0 as Wr,a1 as Gn,a2 as ir,a3 as Ke,a4 as G,a5 as Ce,a6 as ve,a7 as E,a8 as be,a9 as Ta,aa as T,ab as ar,ac as wr,ad as Ve,ae as Vn,af as Wn,ag as ka,ah as Pa,ai as Kn,aj as nt,ak as xa,al as Ra,am as Qn,an as Kr,ao as Jn,ap as Yn,aq as Xn,ar as Zn,as as Ea,at as Oa,au as Qr,av as Da,aw as ei,ax as Ma,ay as Aa,az as Ia,aA as Ba,aB as wa,aC as ti,aD as ae,aE as wt,aF as La,aG as Se,aH as ri,aI as ja,aJ as za,aK as $a,aL as Fa,aM as qa}from"./index.f04307b6.js";import{u as Na,m as Jr,r as Ua}from"./media-stream.57b4ea55.js";import{_ as ni}from"./plugin-vue_export-helper.21dcd24c.js";const Ha=M("div",{class:"q-space"});var ii=K({name:"QSpace",setup(){return()=>Ha}}),xt=K({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:r}){const t=b(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>M("div",{class:t.value,role:"toolbar"},Te(r.default))}});const Lr={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Ga=Object.keys(Lr);Lr.all=!0;function Yr(e){const r={};for(const t of Ga)e[t]===!0&&(r[t]=!0);return Object.keys(r).length===0?Lr:(r.horizontal===!0?r.left=r.right=!0:r.left===!0&&r.right===!0&&(r.horizontal=!0),r.vertical===!0?r.up=r.down=!0:r.up===!0&&r.down===!0&&(r.vertical=!0),r.horizontal===!0&&r.vertical===!0&&(r.all=!0),r)}function Xr(e,r){return r.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof r.handler=="function"&&e.target.nodeName.toUpperCase()!=="INPUT"&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(r.uid)===-1)}function Lt(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),pa.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}function or(e,r,t){const n=Bt(e);let i,a=n.left-r.event.x,c=n.top-r.event.y,l=Math.abs(a),o=Math.abs(c);const s=r.direction;s.horizontal===!0&&s.vertical!==!0?i=a<0?"left":"right":s.horizontal!==!0&&s.vertical===!0?i=c<0?"up":"down":s.up===!0&&c<0?(i="up",l>o&&(s.left===!0&&a<0?i="left":s.right===!0&&a>0&&(i="right"))):s.down===!0&&c>0?(i="down",l>o&&(s.left===!0&&a<0?i="left":s.right===!0&&a>0&&(i="right"))):s.left===!0&&a<0?(i="left",l<o&&(s.up===!0&&c<0?i="up":s.down===!0&&c>0&&(i="down"))):s.right===!0&&a>0&&(i="right",l<o&&(s.up===!0&&c<0?i="up":s.down===!0&&c>0&&(i="down")));let u=!1;if(i===void 0&&t===!1){if(r.event.isFirst===!0||r.event.lastDir===void 0)return{};i=r.event.lastDir,u=!0,i==="left"||i==="right"?(n.left-=a,l=0,a=0):(n.top-=c,o=0,c=0)}return{synthetic:u,payload:{evt:e,touch:r.event.mouse!==!0,mouse:r.event.mouse===!0,position:n,direction:i,isFirst:r.event.isFirst,isFinal:t===!0,duration:Date.now()-r.event.time,distance:{x:l,y:o},offset:{x:a,y:c},delta:{x:n.left-r.event.lastX,y:n.top-r.event.lastY}}}}let Va=0;var lt=ha({name:"touch-pan",beforeMount(e,{value:r,modifiers:t}){if(t.mouse!==!0&&He.has.touch!==!0)return;function n(a,c){t.mouse===!0&&c===!0?Wt(a):(t.stop===!0&&nr(a),t.prevent===!0&&It(a))}const i={uid:"qvtp_"+Va++,handler:r,modifiers:t,direction:Yr(t),noop:Rr,mouseStart(a){Xr(a,i)&&va(a)&&(Ie(i,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),i.start(a,!0))},touchStart(a){if(Xr(a,i)){const c=a.target;Ie(i,"temp",[[c,"touchmove","move","notPassiveCapture"],[c,"touchcancel","end","passiveCapture"],[c,"touchend","end","passiveCapture"]]),i.start(a)}},start(a,c){if(He.is.firefox===!0&&rr(e,!0),i.lastEvt=a,c===!0||t.stop===!0){if(i.direction.all!==!0&&(c!==!0||i.modifiers.mouseAllDir!==!0&&i.modifiers.mousealldir!==!0)){const s=a.type.indexOf("mouse")>-1?new MouseEvent(a.type,a):new TouchEvent(a.type,a);a.defaultPrevented===!0&&It(s),a.cancelBubble===!0&&nr(s),Object.assign(s,{qKeyEvent:a.qKeyEvent,qClickOutside:a.qClickOutside,qAnchorHandled:a.qAnchorHandled,qClonedBy:a.qClonedBy===void 0?[i.uid]:a.qClonedBy.concat(i.uid)}),i.initialEvent={target:a.target,event:s}}nr(a)}const{left:l,top:o}=Bt(a);i.event={x:l,y:o,time:Date.now(),mouse:c===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:l,lastY:o}},move(a){if(i.event===void 0)return;const c=Bt(a),l=c.left-i.event.x,o=c.top-i.event.y;if(l===0&&o===0)return;i.lastEvt=a;const s=i.event.mouse===!0,u=()=>{n(a,s);let p;t.preserveCursor!==!0&&t.preservecursor!==!0&&(p=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),s===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Lt(),i.styleCleanup=h=>{if(i.styleCleanup=void 0,p!==void 0&&(document.documentElement.style.cursor=p),document.body.classList.remove("non-selectable"),s===!0){const v=()=>{document.body.classList.remove("no-pointer-events--children")};h!==void 0?setTimeout(()=>{v(),h()},50):v()}else h!==void 0&&h()}};if(i.event.detected===!0){i.event.isFirst!==!0&&n(a,i.event.mouse);const{payload:p,synthetic:h}=or(a,i,!1);p!==void 0&&(i.handler(p)===!1?i.end(a):(i.styleCleanup===void 0&&i.event.isFirst===!0&&u(),i.event.lastX=p.position.left,i.event.lastY=p.position.top,i.event.lastDir=h===!0?void 0:p.direction,i.event.isFirst=!1));return}if(i.direction.all===!0||s===!0&&(i.modifiers.mouseAllDir===!0||i.modifiers.mousealldir===!0)){u(),i.event.detected=!0,i.move(a);return}const f=Math.abs(l),d=Math.abs(o);f!==d&&(i.direction.horizontal===!0&&f>d||i.direction.vertical===!0&&f<d||i.direction.up===!0&&f<d&&o<0||i.direction.down===!0&&f<d&&o>0||i.direction.left===!0&&f>d&&l<0||i.direction.right===!0&&f>d&&l>0?(i.event.detected=!0,i.move(a)):i.end(a,!0))},end(a,c){if(i.event!==void 0){if(Ge(i,"temp"),He.is.firefox===!0&&rr(e,!1),c===!0)i.styleCleanup!==void 0&&i.styleCleanup(),i.event.detected!==!0&&i.initialEvent!==void 0&&i.initialEvent.target.dispatchEvent(i.initialEvent.event);else if(i.event.detected===!0){i.event.isFirst===!0&&i.handler(or(a===void 0?i.lastEvt:a,i).payload);const{payload:l}=or(a===void 0?i.lastEvt:a,i,!0),o=()=>{i.handler(l)};i.styleCleanup!==void 0?i.styleCleanup(o):o()}i.event=void 0,i.initialEvent=void 0,i.lastEvt=void 0}}};if(e.__qtouchpan=i,t.mouse===!0){const a=t.mouseCapture===!0||t.mousecapture===!0?"Capture":"";Ie(i,"main",[[e,"mousedown","mouseStart",`passive${a}`]])}He.has.touch===!0&&Ie(i,"main",[[e,"touchstart","touchStart",`passive${t.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,r){const t=e.__qtouchpan;t!==void 0&&(r.oldValue!==r.value&&(typeof value!="function"&&t.end(),t.handler=r.value),t.direction=Yr(r.modifiers))},beforeUnmount(e){const r=e.__qtouchpan;r!==void 0&&(r.event!==void 0&&r.end(),Ge(r,"main"),Ge(r,"temp"),He.is.firefox===!0&&rr(e,!1),r.styleCleanup!==void 0&&r.styleCleanup(),delete e.__qtouchpan)}});function Be(e,r,t){return t<=r?r:Math.min(t,Math.max(r,e))}const Zr=150;var Wa=K({name:"QDrawer",inheritAttrs:!1,props:{...Er,...ht,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...Or,"onLayout","miniState"],setup(e,{slots:r,emit:t,attrs:n}){const i=se(),{proxy:{$q:a}}=i,c=vt(e,a),{preventBodyScroll:l}=ga(),{registerTimeout:o,removeTimeout:s}=Dr(),u=Kt(mt,me);if(u===me)return console.error("QDrawer needs to be child of QLayout"),me;let f,d=null,p;const h=A(e.behavior==="mobile"||e.behavior!=="desktop"&&u.totalWidth.value<=e.breakpoint),v=b(()=>e.mini===!0&&h.value!==!0),k=b(()=>v.value===!0?e.miniWidth:e.width),g=A(e.showIfAbove===!0&&h.value===!1?!0:e.modelValue===!0),m=b(()=>e.persistent!==!0&&(h.value===!0||ce.value===!0));function P(_,$){if(x(),_!==!1&&u.animate(),pe(0),h.value===!0){const ue=u.instances[C.value];ue!==void 0&&ue.belowBreakpoint===!0&&ue.hide(!1),De(1),u.isContainer.value!==!0&&l(!0)}else De(0),_!==!1&&Zt(!1);o(()=>{_!==!1&&Zt(!0),$!==!0&&t("show",_)},Zr)}function S(_,$){z(),_!==!1&&u.animate(),De(0),pe(U.value*k.value),er(),$!==!0?o(()=>{t("hide",_)},Zr):s()}const{show:y,hide:B}=Mr({showing:g,hideOnRouteChange:m,handleShow:P,handleHide:S}),{addToHistory:x,removeFromHistory:z}=ma(g,B,m),N={belowBreakpoint:h,hide:B},O=b(()=>e.side==="right"),U=b(()=>(a.lang.rtl===!0?-1:1)*(O.value===!0?1:-1)),ne=A(0),Q=A(!1),W=A(!1),Z=A(k.value*U.value),C=b(()=>O.value===!0?"left":"right"),I=b(()=>g.value===!0&&h.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:k.value:0),L=b(()=>e.overlay===!0||e.miniToOverlay===!0||u.view.value.indexOf(O.value?"R":"L")>-1||a.platform.is.ios===!0&&u.isContainer.value===!0),H=b(()=>e.overlay===!1&&g.value===!0&&h.value===!1),ce=b(()=>e.overlay===!0&&g.value===!0&&h.value===!1),ge=b(()=>"fullscreen q-drawer__backdrop"+(g.value===!1&&Q.value===!1?" hidden":"")),ye=b(()=>({backgroundColor:`rgba(0,0,0,${ne.value*.4})`})),q=b(()=>O.value===!0?u.rows.value.top[2]==="r":u.rows.value.top[0]==="l"),le=b(()=>O.value===!0?u.rows.value.bottom[2]==="r":u.rows.value.bottom[0]==="l"),ee=b(()=>{const _={};return u.header.space===!0&&q.value===!1&&(L.value===!0?_.top=`${u.header.offset}px`:u.header.space===!0&&(_.top=`${u.header.size}px`)),u.footer.space===!0&&le.value===!1&&(L.value===!0?_.bottom=`${u.footer.offset}px`:u.footer.space===!0&&(_.bottom=`${u.footer.size}px`)),_}),ie=b(()=>{const _={width:`${k.value}px`,transform:`translateX(${Z.value}px)`};return h.value===!0?_:Object.assign(_,ee.value)}),Pe=b(()=>"q-drawer__content fit "+(u.isContainer.value!==!0?"scroll":"overflow-auto")),Je=b(()=>`q-drawer q-drawer--${e.side}`+(W.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(c.value===!0?" q-drawer--dark q-dark":"")+(Q.value===!0?" no-transition":g.value===!0?"":" q-layout--prevent-focus")+(h.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${v.value===!0?"mini":"standard"}`+(L.value===!0||H.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(q.value===!0?" q-drawer--top-padding":""))),D=b(()=>{const _=a.lang.rtl===!0?e.side:C.value;return[[lt,fa,void 0,{[_]:!0,mouse:!0}]]}),Oe=b(()=>{const _=a.lang.rtl===!0?C.value:e.side;return[[lt,Gr,void 0,{[_]:!0,mouse:!0}]]}),Ye=b(()=>{const _=a.lang.rtl===!0?C.value:e.side;return[[lt,Gr,void 0,{[_]:!0,mouse:!0,mouseAllDir:!0}]]});function Xe(){da(h,e.behavior==="mobile"||e.behavior!=="desktop"&&u.totalWidth.value<=e.breakpoint)}j(h,_=>{_===!0?(f=g.value,g.value===!0&&B(!1)):e.overlay===!1&&e.behavior!=="mobile"&&f!==!1&&(g.value===!0?(pe(0),De(0),er()):y(!1))}),j(()=>e.side,(_,$)=>{u.instances[$]===N&&(u.instances[$]=void 0,u[$].space=!1,u[$].offset=0),u.instances[_]=N,u[_].size=k.value,u[_].space=H.value,u[_].offset=I.value}),j(u.totalWidth,()=>{(u.isContainer.value===!0||document.qScrollPrevented!==!0)&&Xe()}),j(()=>e.behavior+e.breakpoint,Xe),j(u.isContainer,_=>{g.value===!0&&l(_!==!0),_===!0&&Xe()}),j(u.scrollbarWidth,()=>{pe(g.value===!0?0:void 0)}),j(I,_=>{Me("offset",_)}),j(H,_=>{t("onLayout",_),Me("space",_)}),j(O,()=>{pe()}),j(k,_=>{pe(),tr(e.miniToOverlay,_)}),j(()=>e.miniToOverlay,_=>{tr(_,k.value)}),j(()=>a.lang.rtl,()=>{pe()}),j(()=>e.mini,()=>{e.modelValue===!0&&(ua(),u.animate())}),j(v,_=>{t("miniState",_)});function pe(_){_===void 0?Le(()=>{_=g.value===!0?0:k.value,pe(U.value*_)}):(u.isContainer.value===!0&&O.value===!0&&(h.value===!0||Math.abs(_)===k.value)&&(_+=U.value*u.scrollbarWidth.value),Z.value=_)}function De(_){ne.value=_}function Zt(_){const $=_===!0?"remove":u.isContainer.value!==!0?"add":"";$!==""&&document.body.classList[$]("q-body--drawer-toggle")}function ua(){d!==null&&clearTimeout(d),i.proxy&&i.proxy.$el&&i.proxy.$el.classList.add("q-drawer--mini-animate"),W.value=!0,d=setTimeout(()=>{d=null,W.value=!1,i&&i.proxy&&i.proxy.$el&&i.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function fa(_){if(g.value!==!1)return;const $=k.value,ue=Be(_.distance.x,0,$);if(_.isFinal===!0){ue>=Math.min(75,$)===!0?y():(u.animate(),De(0),pe(U.value*$)),Q.value=!1;return}pe((a.lang.rtl===!0?O.value!==!0:O.value)?Math.max($-ue,0):Math.min(0,ue-$)),De(Be(ue/$,0,1)),_.isFirst===!0&&(Q.value=!0)}function Gr(_){if(g.value!==!0)return;const $=k.value,ue=_.direction===e.side,yt=(a.lang.rtl===!0?ue!==!0:ue)?Be(_.distance.x,0,$):0;if(_.isFinal===!0){Math.abs(yt)<Math.min(75,$)===!0?(u.animate(),De(1),pe(0)):B(),Q.value=!1;return}pe(U.value*yt),De(Be(1-yt/$,0,1)),_.isFirst===!0&&(Q.value=!0)}function er(){l(!1),Zt(!0)}function Me(_,$){u.update(e.side,_,$)}function da(_,$){_.value!==$&&(_.value=$)}function tr(_,$){Me("size",_===!0?e.miniWidth:$)}return u.instances[e.side]=N,tr(e.miniToOverlay,k.value),Me("space",H.value),Me("offset",I.value),e.showIfAbove===!0&&e.modelValue!==!0&&g.value===!0&&e["onUpdate:modelValue"]!==void 0&&t("update:modelValue",!0),we(()=>{t("onLayout",H.value),t("miniState",v.value),f=e.showIfAbove===!0;const _=()=>{(g.value===!0?P:S)(!1,!0)};if(u.totalWidth.value!==0){Le(_);return}p=j(u.totalWidth,()=>{p(),p=void 0,g.value===!1&&e.showIfAbove===!0&&h.value===!1?y(!1):_()})}),de(()=>{p!==void 0&&p(),d!==null&&(clearTimeout(d),d=null),g.value===!0&&er(),u.instances[e.side]===N&&(u.instances[e.side]=void 0,Me("size",0),Me("offset",0),Me("space",!1))}),()=>{const _=[];h.value===!0&&(e.noSwipeOpen===!1&&_.push(hr(M("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),D.value)),_.push(Vr("div",{ref:"backdrop",class:ge.value,style:ye.value,"aria-hidden":"true",onClick:B},void 0,"backdrop",e.noSwipeBackdrop!==!0&&g.value===!0,()=>Ye.value)));const $=v.value===!0&&r.mini!==void 0,ue=[M("div",{...n,key:""+$,class:[Pe.value,n.class]},$===!0?r.mini():Te(r.default))];return e.elevated===!0&&g.value===!0&&ue.push(M("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),_.push(Vr("aside",{ref:"content",class:Je.value,style:ie.value},ue,"contentclose",e.noSwipeClose!==!0&&h.value===!0,()=>Oe.value)),M("div",{class:"q-drawer-container"},_)}}}),Ka=K({name:"QPageContainer",setup(e,{slots:r}){const{proxy:{$q:t}}=se(),n=Kt(mt,me);if(n===me)return console.error("QPageContainer needs to be child of QLayout"),me;Nn(ya,!0);const i=b(()=>{const a={};return n.header.space===!0&&(a.paddingTop=`${n.header.size}px`),n.right.space===!0&&(a[`padding${t.lang.rtl===!0?"Left":"Right"}`]=`${n.right.size}px`),n.footer.space===!0&&(a.paddingBottom=`${n.footer.size}px`),n.left.space===!0&&(a[`padding${t.lang.rtl===!0?"Right":"Left"}`]=`${n.left.size}px`),a});return()=>M("div",{class:"q-page-container",style:i.value},Te(r.default))}});function Qa(){const e=A(!Ar.value);return e.value===!1&&we(()=>{e.value=!0}),e}const ai=typeof ResizeObserver<"u",en=ai===!0?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"};var We=K({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(e,{emit:r}){let t=null,n,i={width:-1,height:-1};function a(o){o===!0||e.debounce===0||e.debounce==="0"?c():t===null&&(t=setTimeout(c,e.debounce))}function c(){if(t!==null&&(clearTimeout(t),t=null),n){const{offsetWidth:o,offsetHeight:s}=n;(o!==i.width||s!==i.height)&&(i={width:o,height:s},r("resize",i))}}const{proxy:l}=se();if(ai===!0){let o;const s=u=>{n=l.$el.parentNode,n?(o=new ResizeObserver(a),o.observe(n),c()):u!==!0&&Le(()=>{s(!0)})};return we(()=>{s()}),de(()=>{t!==null&&clearTimeout(t),o!==void 0&&(o.disconnect!==void 0?o.disconnect():n&&o.unobserve(n))}),Rr}else{let u=function(){t!==null&&(clearTimeout(t),t=null),s!==void 0&&(s.removeEventListener!==void 0&&s.removeEventListener("resize",a,Ne.passive),s=void 0)},f=function(){u(),n&&n.contentDocument&&(s=n.contentDocument.defaultView,s.addEventListener("resize",a,Ne.passive),c())};const o=Qa();let s;return we(()=>{Le(()=>{n=l.$el,n&&f()})}),de(u),l.trigger=a,()=>{if(o.value===!0)return M("object",{style:en.style,tabindex:-1,type:"text/html",data:en.url,"aria-hidden":"true",onLoad:f})}}}}),Ja=K({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:r,emit:t}){const{proxy:{$q:n}}=se(),i=Kt(mt,me);if(i===me)return console.error("QFooter needs to be child of QLayout"),me;const a=A(parseInt(e.heightHint,10)),c=A(!0),l=A(Ar.value===!0||i.isContainer.value===!0?0:window.innerHeight),o=b(()=>e.reveal===!0||i.view.value.indexOf("F")>-1||n.platform.is.ios&&i.isContainer.value===!0),s=b(()=>i.isContainer.value===!0?i.containerHeight.value:l.value),u=b(()=>{if(e.modelValue!==!0)return 0;if(o.value===!0)return c.value===!0?a.value:0;const y=i.scroll.value.position+s.value+a.value-i.height.value;return y>0?y:0}),f=b(()=>e.modelValue!==!0||o.value===!0&&c.value!==!0),d=b(()=>e.modelValue===!0&&f.value===!0&&e.reveal===!0),p=b(()=>"q-footer q-layout__section--marginal "+(o.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(f.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(o.value!==!0?" hidden":""):"")),h=b(()=>{const y=i.rows.value.bottom,B={};return y[0]==="l"&&i.left.space===!0&&(B[n.lang.rtl===!0?"right":"left"]=`${i.left.size}px`),y[2]==="r"&&i.right.space===!0&&(B[n.lang.rtl===!0?"left":"right"]=`${i.right.size}px`),B});function v(y,B){i.update("footer",y,B)}function k(y,B){y.value!==B&&(y.value=B)}function g({height:y}){k(a,y),v("size",y)}function m(){if(e.reveal!==!0)return;const{direction:y,position:B,inflectionPoint:x}=i.scroll.value;k(c,y==="up"||B-x<100||i.height.value-s.value-B-a.value<300)}function P(y){d.value===!0&&k(c,!0),t("focusin",y)}j(()=>e.modelValue,y=>{v("space",y),k(c,!0),i.animate()}),j(u,y=>{v("offset",y)}),j(()=>e.reveal,y=>{y===!1&&k(c,e.modelValue)}),j(c,y=>{i.animate(),t("reveal",y)}),j([a,i.scroll,i.height],m),j(()=>n.screen.height,y=>{i.isContainer.value!==!0&&k(l,y)});const S={};return i.instances.footer=S,e.modelValue===!0&&v("size",a.value),v("space",e.modelValue),v("offset",u.value),de(()=>{i.instances.footer===S&&(i.instances.footer=void 0,v("size",0),v("offset",0),v("space",!1))}),()=>{const y=Ir(r.default,[M(We,{debounce:0,onResize:g})]);return e.elevated===!0&&y.push(M("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),M("footer",{class:p.value,style:h.value,onFocusin:P},y)}}});const{passive:tn}=Ne,Ya=["both","horizontal","vertical"];var oi=K({name:"QScrollObserver",props:{axis:{type:String,validator:e=>Ya.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:{default:void 0}},emits:["scroll"],setup(e,{emit:r}){const t={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let n=null,i,a;j(()=>e.scrollTarget,()=>{o(),l()});function c(){n!==null&&n();const f=Math.max(0,kt(i)),d=ba(i),p={top:f-t.position.top,left:d-t.position.left};if(e.axis==="vertical"&&p.top===0||e.axis==="horizontal"&&p.left===0)return;const h=Math.abs(p.top)>=Math.abs(p.left)?p.top<0?"up":"down":p.left<0?"left":"right";t.position={top:f,left:d},t.directionChanged=t.direction!==h,t.delta=p,t.directionChanged===!0&&(t.direction=h,t.inflectionPoint=t.position),r("scroll",{...t})}function l(){i=Qt(a,e.scrollTarget),i.addEventListener("scroll",s,tn),s(!0)}function o(){i!==void 0&&(i.removeEventListener("scroll",s,tn),i=void 0)}function s(f){if(f===!0||e.debounce===0||e.debounce==="0")c();else if(n===null){const[d,p]=e.debounce?[setTimeout(c,e.debounce),clearTimeout]:[requestAnimationFrame(c),cancelAnimationFrame];n=()=>{p(d),n=null}}}const{proxy:u}=se();return j(()=>u.$q.lang.rtl,c),we(()=>{a=u.$el.parentNode,l()}),de(()=>{n!==null&&n(),o()}),Object.assign(u,{trigger:s,getPosition:()=>t}),Rr}}),Xa=K({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:r,emit:t}){const{proxy:{$q:n}}=se(),i=A(null),a=A(n.screen.height),c=A(e.container===!0?0:n.screen.width),l=A({position:0,direction:"down",inflectionPoint:0}),o=A(0),s=A(Ar.value===!0?0:Pt()),u=b(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),f=b(()=>e.container===!1?{minHeight:n.screen.height+"px"}:null),d=b(()=>s.value!==0?{[n.lang.rtl===!0?"left":"right"]:`${s.value}px`}:null),p=b(()=>s.value!==0?{[n.lang.rtl===!0?"right":"left"]:0,[n.lang.rtl===!0?"left":"right"]:`-${s.value}px`,width:`calc(100% + ${s.value}px)`}:null);function h(S){if(e.container===!0||document.qScrollPrevented!==!0){const y={position:S.position.top,direction:S.direction,directionChanged:S.directionChanged,inflectionPoint:S.inflectionPoint.top,delta:S.delta.top};l.value=y,e.onScroll!==void 0&&t("scroll",y)}}function v(S){const{height:y,width:B}=S;let x=!1;a.value!==y&&(x=!0,a.value=y,e.onScrollHeight!==void 0&&t("scrollHeight",y),g()),c.value!==B&&(x=!0,c.value=B),x===!0&&e.onResize!==void 0&&t("resize",S)}function k({height:S}){o.value!==S&&(o.value=S,g())}function g(){if(e.container===!0){const S=a.value>o.value?Pt():0;s.value!==S&&(s.value=S)}}let m=null;const P={instances:{},view:b(()=>e.view),isContainer:b(()=>e.container),rootRef:i,height:a,containerHeight:o,scrollbarWidth:s,totalWidth:b(()=>c.value+s.value),rows:b(()=>{const S=e.view.toLowerCase().split(" ");return{top:S[0].split(""),middle:S[1].split(""),bottom:S[2].split("")}}),header:rt({size:0,offset:0,space:!1}),right:rt({size:300,offset:0,space:!1}),footer:rt({size:0,offset:0,space:!1}),left:rt({size:300,offset:0,space:!1}),scroll:l,animate(){m!==null?clearTimeout(m):document.body.classList.add("q-body--layout-animate"),m=setTimeout(()=>{m=null,document.body.classList.remove("q-body--layout-animate")},155)},update(S,y,B){P[S][y]=B}};if(Nn(mt,P),Pt()>0){let B=function(){S=null,y.classList.remove("hide-scrollbar")},x=function(){if(S===null){if(y.scrollHeight>n.screen.height)return;y.classList.add("hide-scrollbar")}else clearTimeout(S);S=setTimeout(B,300)},z=function(N){S!==null&&N==="remove"&&(clearTimeout(S),B()),window[`${N}EventListener`]("resize",x)},S=null;const y=document.body;j(()=>e.container!==!0?"add":"remove",z),e.container!==!0&&z("add"),_a(()=>{z("remove")})}return()=>{const S=Ir(r.default,[M(oi,{onScroll:h}),M(We,{onResize:v})]),y=M("div",{class:u.value,style:f.value,ref:e.container===!0?void 0:i,tabindex:-1},S);return e.container===!0?M("div",{class:"q-layout-container overflow-hidden",ref:i},[M(We,{onResize:k}),M("div",{class:"absolute-full",style:d.value},[M("div",{class:"scroll",style:p.value},[y])])]):y}}});const vr="123456789abcdefghijkmnpqrstvwxyz",jt="0",Za=Object.fromEntries(vr.split("").map((e,r)=>[e,r]));function eo(e){const r=new DataView(e);let t=0,n=0,i="";for(let a=0;a<r.byteLength;a++)for(n=n<<8|r.getUint8(a),t+=8;t>=5;)i+=vr[n>>>t-5&31],t-=5;return t>0&&(i+=vr[n<<5-t&31]),i+=jt,i}function to(e){if(!e.endsWith(jt))throw new Error(`Base33 encoding needs to end with a '${jt}'.`);const r=e.slice(0,-1),t=r.length,n=Math.floor(t*5/8);let i=0,a=0,c=0;const l=new Uint8Array(n);for(let o=0;o<t;o++)a=a<<5|Za[r[o]],i+=5,i>=8&&(l[c++]=a>>>i-8&255,i-=8);return l.buffer}var jr={exports:{}};(function(e){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch{return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return new Blob([new Uint8Array([])]).size===0}catch{return!0}}(),e.exports.binaryFeatures=r;var t=e.exports.BlobBuilder;typeof window<"u"&&(t=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);function n(){this._pieces=[],this._parts=[]}n.prototype.append=function(i){typeof i=="number"?this._pieces.push(i):(this.flush(),this._parts.push(i))},n.prototype.flush=function(){if(this._pieces.length>0){var i=new Uint8Array(this._pieces);r.useArrayBufferView||(i=i.buffer),this._parts.push(i),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var i=new t,a=0,c=this._parts.length;a<c;a++)i.append(this._parts[a]);return i.getBlob()}else return new Blob(this._parts)},e.exports.BufferBuilder=n})(jr);var ro=jr.exports.BufferBuilder,rn=jr.exports.binaryFeatures,no={unpack:function(e){var r=new Y(e);return r.unpack()},pack:function(e){var r=new X;r.pack(e);var t=r.getBuffer();return t}},nn=no;function Y(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}Y.prototype.unpack=function(){var e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;var r;if((r=e^160)<=15)return this.unpack_raw(r);if((r=e^176)<=15)return this.unpack_string(r);if((r=e^144)<=15)return this.unpack_array(r);if((r=e^128)<=15)return this.unpack_map(r);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return r=this.unpack_uint16(),this.unpack_string(r);case 217:return r=this.unpack_uint32(),this.unpack_string(r);case 218:return r=this.unpack_uint16(),this.unpack_raw(r);case 219:return r=this.unpack_uint32(),this.unpack_raw(r);case 220:return r=this.unpack_uint16(),this.unpack_array(r);case 221:return r=this.unpack_uint32(),this.unpack_array(r);case 222:return r=this.unpack_uint16(),this.unpack_map(r);case 223:return r=this.unpack_uint32(),this.unpack_map(r)}};Y.prototype.unpack_uint8=function(){var e=this.dataView[this.index]&255;return this.index++,e};Y.prototype.unpack_uint16=function(){var e=this.read(2),r=(e[0]&255)*256+(e[1]&255);return this.index+=2,r};Y.prototype.unpack_uint32=function(){var e=this.read(4),r=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,r};Y.prototype.unpack_uint64=function(){var e=this.read(8),r=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,r};Y.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-(1<<8)};Y.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-(1<<16)};Y.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)};Y.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)};Y.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var r=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,r};Y.prototype.unpack_string=function(e){for(var r=this.read(e),t=0,n="",i,a;t<e;)i=r[t],i<128?(n+=String.fromCharCode(i),t++):(i^192)<32?(a=(i^192)<<6|r[t+1]&63,n+=String.fromCharCode(a),t+=2):(a=(i&15)<<12|(r[t+1]&63)<<6|r[t+2]&63,n+=String.fromCharCode(a),t+=3);return this.index+=e,n};Y.prototype.unpack_array=function(e){for(var r=new Array(e),t=0;t<e;t++)r[t]=this.unpack();return r};Y.prototype.unpack_map=function(e){for(var r={},t=0;t<e;t++){var n=this.unpack(),i=this.unpack();r[n]=i}return r};Y.prototype.unpack_float=function(){var e=this.unpack_uint32(),r=e>>31,t=(e>>23&255)-127,n=e&8388607|8388608;return(r===0?1:-1)*n*Math.pow(2,t-23)};Y.prototype.unpack_double=function(){var e=this.unpack_uint32(),r=this.unpack_uint32(),t=e>>31,n=(e>>20&2047)-1023,i=e&1048575|1048576,a=i*Math.pow(2,n-20)+r*Math.pow(2,n-52);return(t===0?1:-1)*a};Y.prototype.read=function(e){var r=this.index;if(r+e<=this.length)return this.dataView.subarray(r,r+e);throw new Error("BinaryPackFailure: read index out of range")};function X(){this.bufferBuilder=new ro}X.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()};X.prototype.pack=function(e){var r=typeof e;if(r==="string")this.pack_string(e);else if(r==="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(r==="boolean")e===!0?this.bufferBuilder.append(195):e===!1&&this.bufferBuilder.append(194);else if(r==="undefined")this.bufferBuilder.append(192);else if(r==="object")if(e===null)this.bufferBuilder.append(192);else{var t=e.constructor;if(t==Array)this.pack_array(e);else if(t==Blob||t==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(t==ArrayBuffer)rn.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)rn.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(t==Object||t.toString().startsWith("class"))this.pack_object(e);else if(t==Date)this.pack_string(e.toString());else if(typeof e.toBinaryPack=="function")this.bufferBuilder.append(e.toBinaryPack());else throw new Error('Type "'+t.toString()+'" not yet supported')}else throw new Error('Type "'+r+'" not yet supported');this.bufferBuilder.flush()};X.prototype.pack_bin=function(e){var r=e.length||e.byteLength||e.size;if(r<=15)this.pack_uint8(160+r);else if(r<=65535)this.bufferBuilder.append(218),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(219),this.pack_uint32(r);else throw new Error("Invalid length");this.bufferBuilder.append(e)};X.prototype.pack_string=function(e){var r=ao(e);if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this.bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this.bufferBuilder.append(e)};X.prototype.pack_array=function(e){var r=e.length;if(r<=15)this.pack_uint8(144+r);else if(r<=65535)this.bufferBuilder.append(220),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(221),this.pack_uint32(r);else throw new Error("Invalid length");for(var t=0;t<r;t++)this.pack(e[t])};X.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(e&255);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this.bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this.bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")};X.prototype.pack_double=function(e){var r=0;e<0&&(r=1,e=-e);var t=Math.floor(Math.log(e)/Math.LN2),n=e/Math.pow(2,t)-1,i=Math.floor(n*Math.pow(2,52)),a=Math.pow(2,32),c=r<<31|t+1023<<20|i/a&1048575,l=i%a;this.bufferBuilder.append(203),this.pack_int32(c),this.pack_int32(l)};X.prototype.pack_object=function(e){var r=Object.keys(e),t=r.length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else if(t<=4294967295)this.bufferBuilder.append(223),this.pack_uint32(t);else throw new Error("Invalid length");for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))};X.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)};X.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(e&255)};X.prototype.pack_uint32=function(e){var r=e&4294967295;this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};X.prototype.pack_uint64=function(e){var r=e/Math.pow(2,32),t=e%Math.pow(2,32);this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255),this.bufferBuilder.append((t&4278190080)>>>24),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255)};X.prototype.pack_int8=function(e){this.bufferBuilder.append(e&255)};X.prototype.pack_int16=function(e){this.bufferBuilder.append((e&65280)>>8),this.bufferBuilder.append(e&255)};X.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255)};X.prototype.pack_int64=function(e){var r=Math.floor(e/Math.pow(2,32)),t=e%Math.pow(2,32);this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255),this.bufferBuilder.append((t&4278190080)>>>24),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255)};function io(e){var r=e.charCodeAt(0);return r<=2047?"00":r<=65535?"000":r<=2097151?"0000":r<=67108863?"00000":"000000"}function ao(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,io).length}let si=!0,ci=!0;function it(e,r,t){const n=e.match(r);return n&&n.length>=t&&parseInt(n[t],10)}function Qe(e,r,t){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(c,l){if(c!==r)return i.apply(this,arguments);const o=s=>{const u=t(s);u&&(l.handleEvent?l.handleEvent(u):l(u))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(l,o),i.apply(this,[c,o])};const a=n.removeEventListener;n.removeEventListener=function(c,l){if(c!==r||!this._eventMap||!this._eventMap[r])return a.apply(this,arguments);if(!this._eventMap[r].has(l))return a.apply(this,arguments);const o=this._eventMap[r].get(l);return this._eventMap[r].delete(l),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[c,o])},Object.defineProperty(n,"on"+r,{get(){return this["_on"+r]},set(c){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),c&&this.addEventListener(r,this["_on"+r]=c)},enumerable:!0,configurable:!0})}function oo(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(si=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function so(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(ci=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function zr(){if(typeof window=="object"){if(si)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Jt(e,r){!ci||console.warn(e+" is deprecated, please use "+r+" instead.")}function co(e){const r={browser:null,version:null};if(typeof e>"u"||!e.navigator)return r.browser="Not a browser.",r;const{navigator:t}=e;if(t.mozGetUserMedia)r.browser="firefox",r.version=it(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=it(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=it(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=it(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return r.browser="Not a supported browser.",r;return r}function an(e){return Object.prototype.toString.call(e)==="[object Object]"}function li(e){return an(e)?Object.keys(e).reduce(function(r,t){const n=an(e[t]),i=n?li(e[t]):e[t],a=n&&!Object.keys(i).length;return i===void 0||a?r:Object.assign(r,{[t]:i})},{}):e}function mr(e,r,t){!r||t.has(r.id)||(t.set(r.id,r),Object.keys(r).forEach(n=>{n.endsWith("Id")?mr(e,e.get(r[n]),t):n.endsWith("Ids")&&r[n].forEach(i=>{mr(e,e.get(i),t)})}))}function on(e,r,t){const n=t?"outbound-rtp":"inbound-rtp",i=new Map;if(r===null)return i;const a=[];return e.forEach(c=>{c.type==="track"&&c.trackIdentifier===r.id&&a.push(c)}),a.forEach(c=>{e.forEach(l=>{l.type===n&&l.trackId===c.id&&mr(e,l,i)})}),i}const sn=zr;function ui(e,r){const t=e&&e.navigator;if(!t.mediaDevices)return;const n=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const o={};return Object.keys(l).forEach(s=>{if(s==="require"||s==="advanced"||s==="mediaSource")return;const u=typeof l[s]=="object"?l[s]:{ideal:l[s]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const f=function(d,p){return d?d+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(u.ideal!==void 0){o.optional=o.optional||[];let d={};typeof u.ideal=="number"?(d[f("min",s)]=u.ideal,o.optional.push(d),d={},d[f("max",s)]=u.ideal,o.optional.push(d)):(d[f("",s)]=u.ideal,o.optional.push(d))}u.exact!==void 0&&typeof u.exact!="number"?(o.mandatory=o.mandatory||{},o.mandatory[f("",s)]=u.exact):["min","max"].forEach(d=>{u[d]!==void 0&&(o.mandatory=o.mandatory||{},o.mandatory[f(d,s)]=u[d])})}),l.advanced&&(o.optional=(o.optional||[]).concat(l.advanced)),o},i=function(l,o){if(r.version>=61)return o(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const s=function(u,f,d){f in u&&!(d in u)&&(u[d]=u[f],delete u[f])};l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","googAutoGainControl"),s(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=n(l.audio)}if(l&&typeof l.video=="object"){let s=l.video.facingMode;s=s&&(typeof s=="object"?s:{ideal:s});const u=r.version<66;if(s&&(s.exact==="user"||s.exact==="environment"||s.ideal==="user"||s.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete l.video.facingMode;let f;if(s.exact==="environment"||s.ideal==="environment"?f=["back","rear"]:(s.exact==="user"||s.ideal==="user")&&(f=["front"]),f)return t.mediaDevices.enumerateDevices().then(d=>{d=d.filter(h=>h.kind==="videoinput");let p=d.find(h=>f.some(v=>h.label.toLowerCase().includes(v)));return!p&&d.length&&f.includes("back")&&(p=d[d.length-1]),p&&(l.video.deviceId=s.exact?{exact:p.deviceId}:{ideal:p.deviceId}),l.video=n(l.video),sn("chrome: "+JSON.stringify(l)),o(l)})}l.video=n(l.video)}return sn("chrome: "+JSON.stringify(l)),o(l)},a=function(l){return r.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(l,o,s){i(l,u=>{t.webkitGetUserMedia(u,o,f=>{s&&s(a(f))})})};if(t.getUserMedia=c.bind(t),t.mediaDevices.getUserMedia){const l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(o){return i(o,s=>l(s).then(u=>{if(s.audio&&!u.getAudioTracks().length||s.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(a(u))))}}}function lo(e,r){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&!!e.navigator.mediaDevices){if(typeof r!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(n){return r(n).then(i=>{const a=n.video&&n.video.width,c=n.video&&n.video.height,l=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:l||3}},a&&(n.video.mandatory.maxWidth=a),c&&(n.video.mandatory.maxHeight=c),e.navigator.mediaDevices.getUserMedia(n)})}}}function fi(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function di(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let a;e.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===i.track.id):a={track:i.track};const c=new Event("track");c.track=i.track,c.receiver=a,c.transceiver={receiver:a},c.streams=[n.stream],this.dispatchEvent(c)}),n.stream.getTracks().forEach(i=>{let a;e.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===i.id):a={track:i};const c=new Event("track");c.track=i,c.receiver=a,c.transceiver={receiver:a},c.streams=[n.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else Qe(e,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function pi(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const r=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(l,o){let s=i.apply(this,arguments);return s||(s=r(this,l),this._senders.push(s)),s};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(l){a.apply(this,arguments);const o=this._senders.indexOf(l);o!==-1&&this._senders.splice(o,1)}}const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],t.apply(this,[a]),a.getTracks().forEach(c=>{this._senders.push(r(this,c))})};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(c=>{const l=this._senders.find(o=>o.track===c);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=r.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function hi(e){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,i,a]=arguments;if(arguments.length>0&&typeof n=="function")return r.apply(this,arguments);if(r.length===0&&(arguments.length===0||typeof n!="function"))return r.apply(this,[]);const c=function(o){const s={};return o.result().forEach(f=>{const d={id:f.id,timestamp:f.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[f.type]||f.type};f.names().forEach(p=>{d[p]=f.stat(p)}),s[d.id]=d}),s},l=function(o){return new Map(Object.keys(o).map(s=>[s,o[s]]))};if(arguments.length>=2){const o=function(s){i(l(c(s)))};return r.apply(this,[o,n])}return new Promise((o,s)=>{r.apply(this,[function(u){o(l(c(u)))},s])}).then(i,a)}}function vi(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(c=>c._pc=this),a});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),e.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(c=>on(c,a.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Qe(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>on(a,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let i,a,c;return this.getSenders().forEach(l=>{l.track===n&&(i?c=!0:i=l)}),this.getReceivers().forEach(l=>(l.track===n&&(a?c=!0:a=l),l.track===n)),c||i&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function mi(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(c,l){if(!l)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=r.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(o)===-1&&this._shimmedLocalStreams[l.id].push(o):this._shimmedLocalStreams[l.id]=[l,o],o};const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(s=>{if(this.getSenders().find(f=>f.track===s))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const o=this.getSenders().filter(s=>l.indexOf(s)===-1);this._shimmedLocalStreams[c.id]=[c].concat(o)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],n.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const o=this._shimmedLocalStreams[l].indexOf(c);o!==-1&&this._shimmedLocalStreams[l].splice(o,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),i.apply(this,arguments)}}function gi(e,r){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&r.version>=65)return mi(e);const t=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const u=t.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(f=>this._reverseStreams[f.id])};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(f=>{if(this.getSenders().find(p=>p.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const f=new e.MediaStream(u.getTracks());this._streams[u.id]=f,this._reverseStreams[f.id]=u,u=f}n.apply(this,[u])};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},e.RTCPeerConnection.prototype.addTrack=function(u,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(v=>v===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(v=>v.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[f.id];if(h)h.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const v=new e.MediaStream([u]);this._streams[f.id]=v,this._reverseStreams[v.id]=f,this.addStream(v)}return this.getSenders().find(v=>v.track===u)};function a(s,u){let f=u.sdp;return Object.keys(s._reverseStreams||[]).forEach(d=>{const p=s._reverseStreams[d],h=s._streams[p.id];f=f.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:f})}function c(s,u){let f=u.sdp;return Object.keys(s._reverseStreams||[]).forEach(d=>{const p=s._reverseStreams[d],h=s._streams[p.id];f=f.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:f})}["createOffer","createAnswer"].forEach(function(s){const u=e.RTCPeerConnection.prototype[s],f={[s](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[h=>{const v=a(this,h);d[0].apply(null,[v])},h=>{d[1]&&d[1].apply(null,h)},arguments[2]]):u.apply(this,arguments).then(h=>a(this,h))}};e.RTCPeerConnection.prototype[s]=f[s]});const l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=c(this,arguments[0]),l.apply(this,arguments))};const o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const s=o.get.apply(this);return s.type===""?s:a(this,s)}}),e.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(v=>u.track===v)&&(d=this._streams[p])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function gr(e,r){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!!e.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function yi(e,r){Qe(e,"negotiationneeded",t=>{const n=t.target;if(!((r.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}var cn=Object.freeze(Object.defineProperty({__proto__:null,shimMediaStream:fi,shimOnTrack:di,shimGetSendersWithDtmf:pi,shimGetStats:hi,shimSenderReceiverGetStats:vi,shimAddTrackRemoveTrackWithNative:mi,shimAddTrackRemoveTrack:gi,shimPeerConnection:gr,fixNegotiationNeeded:yi,shimGetUserMedia:ui,shimGetDisplayMedia:lo},Symbol.toStringTag,{value:"Module"}));function uo(e,r){let t=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(n=>{if(n&&(n.urls||n.url)){let i=n.urls||n.url;n.url&&!n.urls&&Jt("RTCIceServer.url","RTCIceServer.urls");const a=typeof i=="string";return a&&(i=[i]),i=i.filter(c=>{if(c.indexOf("stun:")===0)return!1;const l=c.startsWith("turn")&&!c.startsWith("turn:[")&&c.includes("transport=udp");return l&&!t?(t=!0,!0):l&&!t}),delete n.url,n.urls=a?i[0]:i,!!i.length}})}var $r={exports:{}};(function(e){var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(t){return t.trim().split(`
`).map(function(n){return n.trim()})},r.splitSections=function(t){var n=t.split(`
m=`);return n.map(function(i,a){return(a>0?"m="+i:i).trim()+`\r
`})},r.getDescription=function(t){var n=r.splitSections(t);return n&&n[0]},r.getMediaSections=function(t){var n=r.splitSections(t);return n.shift(),n},r.matchPrefix=function(t,n){return r.splitLines(t).filter(function(i){return i.indexOf(n)===0})},r.parseCandidate=function(t){var n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");for(var i={foundation:n[0],component:parseInt(n[1],10),protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]},a=8;a<n.length;a+=2)switch(n[a]){case"raddr":i.relatedAddress=n[a+1];break;case"rport":i.relatedPort=parseInt(n[a+1],10);break;case"tcptype":i.tcpType=n[a+1];break;case"ufrag":i.ufrag=n[a+1],i.usernameFragment=n[a+1];break;default:i[n[a]]=n[a+1];break}return i},r.writeCandidate=function(t){var n=[];n.push(t.foundation),n.push(t.component),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);var i=t.type;return n.push("typ"),n.push(i),i!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},r.parseIceOptions=function(t){return t.substr(14).split(" ")},r.parseRtpMap=function(t){var n=t.substr(9).split(" "),i={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),i.name=n[0],i.clockRate=parseInt(n[1],10),i.channels=n.length===3?parseInt(n[2],10):1,i.numChannels=i.channels,i},r.writeRtpMap=function(t){var n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);var i=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},r.parseExtmap=function(t){var n=t.substr(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1]}},r.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+`\r
`},r.parseFmtp=function(t){for(var n={},i,a=t.substr(t.indexOf(" ")+1).split(";"),c=0;c<a.length;c++)i=a[c].trim().split("="),n[i[0].trim()]=i[1];return n},r.writeFmtp=function(t){var n="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var a=[];Object.keys(t.parameters).forEach(function(c){t.parameters[c]?a.push(c+"="+t.parameters[c]):a.push(c)}),n+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return n},r.parseRtcpFb=function(t){var n=t.substr(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},r.writeRtcpFb=function(t){var n="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(function(a){n+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),n},r.parseSsrcMedia=function(t){var n=t.indexOf(" "),i={ssrc:parseInt(t.substr(7,n-7),10)},a=t.indexOf(":",n);return a>-1?(i.attribute=t.substr(n+1,a-n-1),i.value=t.substr(a+1)):i.attribute=t.substr(n+1),i},r.parseSsrcGroup=function(t){var n=t.substr(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(function(i){return parseInt(i,10)})}},r.getMid=function(t){var n=r.matchPrefix(t,"a=mid:")[0];if(n)return n.substr(6)},r.parseFingerprint=function(t){var n=t.substr(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1]}},r.getDtlsParameters=function(t,n){var i=r.matchPrefix(t+n,"a=fingerprint:");return{role:"auto",fingerprints:i.map(r.parseFingerprint)}},r.writeDtlsParameters=function(t,n){var i="a=setup:"+n+`\r
`;return t.fingerprints.forEach(function(a){i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},r.parseCryptoLine=function(t){var n=t.substr(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},r.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?r.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;var n=t.substr(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},r.getCryptoParameters=function(t,n){var i=r.matchPrefix(t+n,"a=crypto:");return i.map(r.parseCryptoLine)},r.getIceParameters=function(t,n){var i=r.matchPrefix(t+n,"a=ice-ufrag:")[0],a=r.matchPrefix(t+n,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substr(12),password:a.substr(10)}:null},r.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`},r.parseRtpParameters=function(t){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=r.splitLines(t),a=i[0].split(" "),c=3;c<a.length;c++){var l=a[c],o=r.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(o){var s=r.parseRtpMap(o),u=r.matchPrefix(t,"a=fmtp:"+l+" ");switch(s.parameters=u.length?r.parseFmtp(u[0]):{},s.rtcpFeedback=r.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(r.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase());break}}}return r.matchPrefix(t,"a=extmap:").forEach(function(f){n.headerExtensions.push(r.parseExtmap(f))}),n},r.writeRtpDescription=function(t,n){var i="";i+="m="+t+" ",i+=n.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=n.codecs.map(function(c){return c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType}).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(function(c){i+=r.writeRtpMap(c),i+=r.writeFmtp(c),i+=r.writeRtcpFb(c)});var a=0;return n.codecs.forEach(function(c){c.maxptime>a&&(a=c.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),i+=`a=rtcp-mux\r
`,n.headerExtensions&&n.headerExtensions.forEach(function(c){i+=r.writeExtmap(c)}),i},r.parseRtpEncodingParameters=function(t){var n=[],i=r.parseRtpParameters(t),a=i.fecMechanisms.indexOf("RED")!==-1,c=i.fecMechanisms.indexOf("ULPFEC")!==-1,l=r.matchPrefix(t,"a=ssrc:").map(function(d){return r.parseSsrcMedia(d)}).filter(function(d){return d.attribute==="cname"}),o=l.length>0&&l[0].ssrc,s,u=r.matchPrefix(t,"a=ssrc-group:FID").map(function(d){var p=d.substr(17).split(" ");return p.map(function(h){return parseInt(h,10)})});u.length>0&&u[0].length>1&&u[0][0]===o&&(s=u[0][1]),i.codecs.forEach(function(d){if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){var p={ssrc:o,codecPayloadType:parseInt(d.parameters.apt,10)};o&&s&&(p.rtx={ssrc:s}),n.push(p),a&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:o,mechanism:c?"red+ulpfec":"red"},n.push(p))}}),n.length===0&&o&&n.push({ssrc:o});var f=r.matchPrefix(t,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substr(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substr(5),10)*1e3*.95-50*40*8:f=void 0,n.forEach(function(d){d.maxBitrate=f})),n},r.parseRtcpParameters=function(t){var n={},i=r.matchPrefix(t,"a=ssrc:").map(function(l){return r.parseSsrcMedia(l)}).filter(function(l){return l.attribute==="cname"})[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);var a=r.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=a.length>0,n.compound=a.length===0;var c=r.matchPrefix(t,"a=rtcp-mux");return n.mux=c.length>0,n},r.parseMsid=function(t){var n,i=r.matchPrefix(t,"a=msid:");if(i.length===1)return n=i[0].substr(7).split(" "),{stream:n[0],track:n[1]};var a=r.matchPrefix(t,"a=ssrc:").map(function(c){return r.parseSsrcMedia(c)}).filter(function(c){return c.attribute==="msid"});if(a.length>0)return n=a[0].value.split(" "),{stream:n[0],track:n[1]}},r.parseSctpDescription=function(t){var n=r.parseMLine(t),i=r.matchPrefix(t,"a=max-message-size:"),a;i.length>0&&(a=parseInt(i[0].substr(19),10)),isNaN(a)&&(a=65536);var c=r.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substr(12),10),protocol:n.fmt,maxMessageSize:a};var l=r.matchPrefix(t,"a=sctpmap:");if(l.length>0){var o=r.matchPrefix(t,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:a}}},r.writeSctpDescription=function(t,n){var i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&i.push("a=max-message-size:"+n.maxMessageSize+`\r
`),i.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(t,n,i){var a,c=n!==void 0?n:2;t?a=t:a=r.generateSessionId();var l=i||"thisisadapterortc";return`v=0\r
o=`+l+" "+a+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.writeMediaSection=function(t,n,i,a){var c=r.writeRtpDescription(t.kind,n);if(c+=r.writeIceParameters(t.iceGatherer.getLocalParameters()),c+=r.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),i==="offer"?"actpass":"active"),c+="a=mid:"+t.mid+`\r
`,t.direction?c+="a="+t.direction+`\r
`:t.rtpSender&&t.rtpReceiver?c+=`a=sendrecv\r
`:t.rtpSender?c+=`a=sendonly\r
`:t.rtpReceiver?c+=`a=recvonly\r
`:c+=`a=inactive\r
`,t.rtpSender){var l="msid:"+a.id+" "+t.rtpSender.track.id+`\r
`;c+="a="+l,c+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+l,t.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+l,c+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return c+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+`\r
`,t.rtpSender&&t.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+`\r
`),c},r.getDirection=function(t,n){for(var i=r.splitLines(t),a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substr(2)}return n?r.getDirection(n):"sendrecv"},r.getKind=function(t){var n=r.splitLines(t),i=n[0].split(" ");return i[0].substr(2)},r.isRejected=function(t){return t.split(" ",2)[1]==="0"},r.parseMLine=function(t){var n=r.splitLines(t),i=n[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},r.parseOLine=function(t){var n=r.matchPrefix(t,"o=")[0],i=n.substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},r.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;for(var n=r.splitLines(t),i=0;i<n.length;i++)if(n[i].length<2||n[i].charAt(1)!=="=")return!1;return!0},e.exports=r})($r);var Rt=$r.exports,w=$r.exports;function fo(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function ln(e,r,t,n,i){var a=w.writeRtpDescription(e.kind,r);if(a+=w.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=w.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),t==="offer"?"actpass":i||"active"),a+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?a+=`a=sendrecv\r
`:e.rtpSender?a+=`a=sendonly\r
`:e.rtpReceiver?a+=`a=recvonly\r
`:a+=`a=inactive\r
`,e.rtpSender){var c=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=c;var l="msid:"+(n?n.id:"-")+" "+c+`\r
`;a+="a="+l,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+l,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+l,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+w.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+w.localCName+`\r
`),a}function po(e,r){var t=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(function(n){if(n&&(n.urls||n.url)){var i=n.urls||n.url;n.url&&!n.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var a=typeof i=="string";return a&&(i=[i]),i=i.filter(function(c){var l=c.indexOf("turn:")===0&&c.indexOf("transport=udp")!==-1&&c.indexOf("turn:[")===-1&&!t;return l?(t=!0,!0):c.indexOf("stun:")===0&&r>=14393&&c.indexOf("?transport=udp")===-1}),delete n.url,n.urls=a?i[0]:i,!!i.length}})}function _t(e,r){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(a,c){a=parseInt(a,10);for(var l=0;l<c.length;l++)if(c[l].payloadType===a||c[l].preferredPayloadType===a)return c[l]},i=function(a,c,l,o){var s=n(a.parameters.apt,l),u=n(c.parameters.apt,o);return s&&u&&s.name.toLowerCase()===u.name.toLowerCase()};return e.codecs.forEach(function(a){for(var c=0;c<r.codecs.length;c++){var l=r.codecs[c];if(a.name.toLowerCase()===l.name.toLowerCase()&&a.clockRate===l.clockRate){if(a.name.toLowerCase()==="rtx"&&a.parameters&&l.parameters.apt&&!i(a,l,e.codecs,r.codecs))continue;l=JSON.parse(JSON.stringify(l)),l.numChannels=Math.min(a.numChannels,l.numChannels),t.codecs.push(l),l.rtcpFeedback=l.rtcpFeedback.filter(function(o){for(var s=0;s<a.rtcpFeedback.length;s++)if(a.rtcpFeedback[s].type===o.type&&a.rtcpFeedback[s].parameter===o.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(a){for(var c=0;c<r.headerExtensions.length;c++){var l=r.headerExtensions[c];if(a.uri===l.uri){t.headerExtensions.push(l);break}}}),t}function un(e,r,t){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[r][e].indexOf(t)!==-1}function sr(e,r){var t=e.getRemoteCandidates().find(function(n){return r.foundation===n.foundation&&r.ip===n.ip&&r.port===n.port&&r.priority===n.priority&&r.protocol===n.protocol&&r.type===n.type});return t||e.addRemoteCandidate(r),!t}function te(e,r){var t=new Error(r);return t.name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}var ho=function(e,r){function t(o,s){s.addTrack(o),s.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:o}))}function n(o,s){s.removeTrack(o),s.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:o}))}function i(o,s,u,f){var d=new Event("track");d.track=s,d.receiver=u,d.transceiver={receiver:u},d.streams=f,e.setTimeout(function(){o._dispatchEvent("track",d)})}var a=function(o){var s=this,u=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(d){s[d]=u[d].bind(u)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",o=JSON.parse(JSON.stringify(o||{})),this.usingBundle=o.bundlePolicy==="max-bundle",o.rtcpMuxPolicy==="negotiate")throw te("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(o.rtcpMuxPolicy||(o.rtcpMuxPolicy="require"),o.iceTransportPolicy){case"all":case"relay":break;default:o.iceTransportPolicy="all";break}switch(o.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:o.bundlePolicy="balanced";break}if(o.iceServers=po(o.iceServers||[],r),this._iceGatherers=[],o.iceCandidatePoolSize)for(var f=o.iceCandidatePoolSize;f>0;f--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:o.iceServers,gatherPolicy:o.iceTransportPolicy}));else o.iceCandidatePoolSize=0;this._config=o,this.transceivers=[],this._sdpSessionId=w.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(a.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(a.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),a.prototype.onicecandidate=null,a.prototype.onaddstream=null,a.prototype.ontrack=null,a.prototype.onremovestream=null,a.prototype.onsignalingstatechange=null,a.prototype.oniceconnectionstatechange=null,a.prototype.onconnectionstatechange=null,a.prototype.onicegatheringstatechange=null,a.prototype.onnegotiationneeded=null,a.prototype.ondatachannel=null,a.prototype._dispatchEvent=function(o,s){this._isClosed||(this.dispatchEvent(s),typeof this["on"+o]=="function"&&this["on"+o](s))},a.prototype._emitGatheringStateChange=function(){var o=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",o)},a.prototype.getConfiguration=function(){return this._config},a.prototype.getLocalStreams=function(){return this.localStreams},a.prototype.getRemoteStreams=function(){return this.remoteStreams},a.prototype._createTransceiver=function(o,s){var u=this.transceivers.length>0,f={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:o,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&u)f.iceTransport=this.transceivers[0].iceTransport,f.dtlsTransport=this.transceivers[0].dtlsTransport;else{var d=this._createIceAndDtlsTransports();f.iceTransport=d.iceTransport,f.dtlsTransport=d.dtlsTransport}return s||this.transceivers.push(f),f},a.prototype.addTrack=function(o,s){if(this._isClosed)throw te("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var u=this.transceivers.find(function(p){return p.track===o});if(u)throw te("InvalidAccessError","Track already exists.");for(var f,d=0;d<this.transceivers.length;d++)!this.transceivers[d].track&&this.transceivers[d].kind===o.kind&&(f=this.transceivers[d]);return f||(f=this._createTransceiver(o.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(s)===-1&&this.localStreams.push(s),f.track=o,f.stream=s,f.rtpSender=new e.RTCRtpSender(o,f.dtlsTransport),f.rtpSender},a.prototype.addStream=function(o){var s=this;if(r>=15025)o.getTracks().forEach(function(f){s.addTrack(f,o)});else{var u=o.clone();o.getTracks().forEach(function(f,d){var p=u.getTracks()[d];f.addEventListener("enabled",function(h){p.enabled=h.enabled})}),u.getTracks().forEach(function(f){s.addTrack(f,u)})}},a.prototype.removeTrack=function(o){if(this._isClosed)throw te("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(o instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var s=this.transceivers.find(function(d){return d.rtpSender===o});if(!s)throw te("InvalidAccessError","Sender was not created by this connection.");var u=s.stream;s.rtpSender.stop(),s.rtpSender=null,s.track=null,s.stream=null;var f=this.transceivers.map(function(d){return d.stream});f.indexOf(u)===-1&&this.localStreams.indexOf(u)>-1&&this.localStreams.splice(this.localStreams.indexOf(u),1),this._maybeFireNegotiationNeeded()},a.prototype.removeStream=function(o){var s=this;o.getTracks().forEach(function(u){var f=s.getSenders().find(function(d){return d.track===u});f&&s.removeTrack(f)})},a.prototype.getSenders=function(){return this.transceivers.filter(function(o){return!!o.rtpSender}).map(function(o){return o.rtpSender})},a.prototype.getReceivers=function(){return this.transceivers.filter(function(o){return!!o.rtpReceiver}).map(function(o){return o.rtpReceiver})},a.prototype._createIceGatherer=function(o,s){var u=this;if(s&&o>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var f=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(f,"state",{value:"new",writable:!0}),this.transceivers[o].bufferedCandidateEvents=[],this.transceivers[o].bufferCandidates=function(d){var p=!d.candidate||Object.keys(d.candidate).length===0;f.state=p?"completed":"gathering",u.transceivers[o].bufferedCandidateEvents!==null&&u.transceivers[o].bufferedCandidateEvents.push(d)},f.addEventListener("localcandidate",this.transceivers[o].bufferCandidates),f},a.prototype._gather=function(o,s){var u=this,f=this.transceivers[s].iceGatherer;if(!f.onlocalcandidate){var d=this.transceivers[s].bufferedCandidateEvents;this.transceivers[s].bufferedCandidateEvents=null,f.removeEventListener("localcandidate",this.transceivers[s].bufferCandidates),f.onlocalcandidate=function(p){if(!(u.usingBundle&&s>0)){var h=new Event("icecandidate");h.candidate={sdpMid:o,sdpMLineIndex:s};var v=p.candidate,k=!v||Object.keys(v).length===0;if(k)(f.state==="new"||f.state==="gathering")&&(f.state="completed");else{f.state==="new"&&(f.state="gathering"),v.component=1,v.ufrag=f.getLocalParameters().usernameFragment;var g=w.writeCandidate(v);h.candidate=Object.assign(h.candidate,w.parseCandidate(g)),h.candidate.candidate=g,h.candidate.toJSON=function(){return{candidate:h.candidate.candidate,sdpMid:h.candidate.sdpMid,sdpMLineIndex:h.candidate.sdpMLineIndex,usernameFragment:h.candidate.usernameFragment}}}var m=w.getMediaSections(u._localDescription.sdp);k?m[h.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:m[h.candidate.sdpMLineIndex]+="a="+h.candidate.candidate+`\r
`,u._localDescription.sdp=w.getDescription(u._localDescription.sdp)+m.join("");var P=u.transceivers.every(function(S){return S.iceGatherer&&S.iceGatherer.state==="completed"});u.iceGatheringState!=="gathering"&&(u.iceGatheringState="gathering",u._emitGatheringStateChange()),k||u._dispatchEvent("icecandidate",h),P&&(u._dispatchEvent("icecandidate",new Event("icecandidate")),u.iceGatheringState="complete",u._emitGatheringStateChange())}},e.setTimeout(function(){d.forEach(function(p){f.onlocalcandidate(p)})},0)}},a.prototype._createIceAndDtlsTransports=function(){var o=this,s=new e.RTCIceTransport(null);s.onicestatechange=function(){o._updateIceConnectionState(),o._updateConnectionState()};var u=new e.RTCDtlsTransport(s);return u.ondtlsstatechange=function(){o._updateConnectionState()},u.onerror=function(){Object.defineProperty(u,"state",{value:"failed",writable:!0}),o._updateConnectionState()},{iceTransport:s,dtlsTransport:u}},a.prototype._disposeIceAndDtlsTransports=function(o){var s=this.transceivers[o].iceGatherer;s&&(delete s.onlocalcandidate,delete this.transceivers[o].iceGatherer);var u=this.transceivers[o].iceTransport;u&&(delete u.onicestatechange,delete this.transceivers[o].iceTransport);var f=this.transceivers[o].dtlsTransport;f&&(delete f.ondtlsstatechange,delete f.onerror,delete this.transceivers[o].dtlsTransport)},a.prototype._transceive=function(o,s,u){var f=_t(o.localCapabilities,o.remoteCapabilities);s&&o.rtpSender&&(f.encodings=o.sendEncodingParameters,f.rtcp={cname:w.localCName,compound:o.rtcpParameters.compound},o.recvEncodingParameters.length&&(f.rtcp.ssrc=o.recvEncodingParameters[0].ssrc),o.rtpSender.send(f)),u&&o.rtpReceiver&&f.codecs.length>0&&(o.kind==="video"&&o.recvEncodingParameters&&r<15019&&o.recvEncodingParameters.forEach(function(d){delete d.rtx}),o.recvEncodingParameters.length?f.encodings=o.recvEncodingParameters:f.encodings=[{}],f.rtcp={compound:o.rtcpParameters.compound},o.rtcpParameters.cname&&(f.rtcp.cname=o.rtcpParameters.cname),o.sendEncodingParameters.length&&(f.rtcp.ssrc=o.sendEncodingParameters[0].ssrc),o.rtpReceiver.receive(f))},a.prototype.setLocalDescription=function(o){var s=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(te("TypeError",'Unsupported type "'+o.type+'"'));if(!un("setLocalDescription",o.type,s.signalingState)||s._isClosed)return Promise.reject(te("InvalidStateError","Can not set local "+o.type+" in state "+s.signalingState));var u,f;if(o.type==="offer")u=w.splitSections(o.sdp),f=u.shift(),u.forEach(function(p,h){var v=w.parseRtpParameters(p);s.transceivers[h].localCapabilities=v}),s.transceivers.forEach(function(p,h){s._gather(p.mid,h)});else if(o.type==="answer"){u=w.splitSections(s._remoteDescription.sdp),f=u.shift();var d=w.matchPrefix(f,"a=ice-lite").length>0;u.forEach(function(p,h){var v=s.transceivers[h],k=v.iceGatherer,g=v.iceTransport,m=v.dtlsTransport,P=v.localCapabilities,S=v.remoteCapabilities,y=w.isRejected(p)&&w.matchPrefix(p,"a=bundle-only").length===0;if(!y&&!v.rejected){var B=w.getIceParameters(p,f),x=w.getDtlsParameters(p,f);d&&(x.role="server"),(!s.usingBundle||h===0)&&(s._gather(v.mid,h),g.state==="new"&&g.start(k,B,d?"controlling":"controlled"),m.state==="new"&&m.start(x));var z=_t(P,S);s._transceive(v,z.codecs.length>0,!1)}})}return s._localDescription={type:o.type,sdp:o.sdp},o.type==="offer"?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},a.prototype.setRemoteDescription=function(o){var s=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(te("TypeError",'Unsupported type "'+o.type+'"'));if(!un("setRemoteDescription",o.type,s.signalingState)||s._isClosed)return Promise.reject(te("InvalidStateError","Can not set remote "+o.type+" in state "+s.signalingState));var u={};s.remoteStreams.forEach(function(g){u[g.id]=g});var f=[],d=w.splitSections(o.sdp),p=d.shift(),h=w.matchPrefix(p,"a=ice-lite").length>0,v=w.matchPrefix(p,"a=group:BUNDLE ").length>0;s.usingBundle=v;var k=w.matchPrefix(p,"a=ice-options:")[0];return k?s.canTrickleIceCandidates=k.substr(14).split(" ").indexOf("trickle")>=0:s.canTrickleIceCandidates=!1,d.forEach(function(g,m){var P=w.splitLines(g),S=w.getKind(g),y=w.isRejected(g)&&w.matchPrefix(g,"a=bundle-only").length===0,B=P[0].substr(2).split(" ")[2],x=w.getDirection(g,p),z=w.parseMsid(g),N=w.getMid(g)||w.generateIdentifier();if(y||S==="application"&&(B==="DTLS/SCTP"||B==="UDP/DTLS/SCTP")){s.transceivers[m]={mid:N,kind:S,protocol:B,rejected:!0};return}!y&&s.transceivers[m]&&s.transceivers[m].rejected&&(s.transceivers[m]=s._createTransceiver(S,!0));var O,U,ne,Q,W,Z,C,I,L,H=w.parseRtpParameters(g),ce,ge;y||(ce=w.getIceParameters(g,p),ge=w.getDtlsParameters(g,p),ge.role="client"),C=w.parseRtpEncodingParameters(g);var ye=w.parseRtcpParameters(g),q=w.matchPrefix(g,"a=end-of-candidates",p).length>0,le=w.matchPrefix(g,"a=candidate:").map(function(D){return w.parseCandidate(D)}).filter(function(D){return D.component===1});if((o.type==="offer"||o.type==="answer")&&!y&&v&&m>0&&s.transceivers[m]&&(s._disposeIceAndDtlsTransports(m),s.transceivers[m].iceGatherer=s.transceivers[0].iceGatherer,s.transceivers[m].iceTransport=s.transceivers[0].iceTransport,s.transceivers[m].dtlsTransport=s.transceivers[0].dtlsTransport,s.transceivers[m].rtpSender&&s.transceivers[m].rtpSender.setTransport(s.transceivers[0].dtlsTransport),s.transceivers[m].rtpReceiver&&s.transceivers[m].rtpReceiver.setTransport(s.transceivers[0].dtlsTransport)),o.type==="offer"&&!y){O=s.transceivers[m]||s._createTransceiver(S),O.mid=N,O.iceGatherer||(O.iceGatherer=s._createIceGatherer(m,v)),le.length&&O.iceTransport.state==="new"&&(q&&(!v||m===0)?O.iceTransport.setRemoteCandidates(le):le.forEach(function(D){sr(O.iceTransport,D)})),I=e.RTCRtpReceiver.getCapabilities(S),r<15019&&(I.codecs=I.codecs.filter(function(D){return D.name!=="rtx"})),Z=O.sendEncodingParameters||[{ssrc:(2*m+2)*1001}];var ee=!1;if(x==="sendrecv"||x==="sendonly"){if(ee=!O.rtpReceiver,W=O.rtpReceiver||new e.RTCRtpReceiver(O.dtlsTransport,S),ee){var ie;L=W.track,z&&z.stream==="-"||(z?(u[z.stream]||(u[z.stream]=new e.MediaStream,Object.defineProperty(u[z.stream],"id",{get:function(){return z.stream}})),Object.defineProperty(L,"id",{get:function(){return z.track}}),ie=u[z.stream]):(u.default||(u.default=new e.MediaStream),ie=u.default)),ie&&(t(L,ie),O.associatedRemoteMediaStreams.push(ie)),f.push([L,W,ie])}}else O.rtpReceiver&&O.rtpReceiver.track&&(O.associatedRemoteMediaStreams.forEach(function(D){var Oe=D.getTracks().find(function(Ye){return Ye.id===O.rtpReceiver.track.id});Oe&&n(Oe,D)}),O.associatedRemoteMediaStreams=[]);O.localCapabilities=I,O.remoteCapabilities=H,O.rtpReceiver=W,O.rtcpParameters=ye,O.sendEncodingParameters=Z,O.recvEncodingParameters=C,s._transceive(s.transceivers[m],!1,ee)}else if(o.type==="answer"&&!y){O=s.transceivers[m],U=O.iceGatherer,ne=O.iceTransport,Q=O.dtlsTransport,W=O.rtpReceiver,Z=O.sendEncodingParameters,I=O.localCapabilities,s.transceivers[m].recvEncodingParameters=C,s.transceivers[m].remoteCapabilities=H,s.transceivers[m].rtcpParameters=ye,le.length&&ne.state==="new"&&((h||q)&&(!v||m===0)?ne.setRemoteCandidates(le):le.forEach(function(D){sr(O.iceTransport,D)})),(!v||m===0)&&(ne.state==="new"&&ne.start(U,ce,"controlling"),Q.state==="new"&&Q.start(ge));var Pe=_t(O.localCapabilities,O.remoteCapabilities),Je=Pe.codecs.filter(function(D){return D.name.toLowerCase()==="rtx"}).length;!Je&&O.sendEncodingParameters[0].rtx&&delete O.sendEncodingParameters[0].rtx,s._transceive(O,x==="sendrecv"||x==="recvonly",x==="sendrecv"||x==="sendonly"),W&&(x==="sendrecv"||x==="sendonly")?(L=W.track,z?(u[z.stream]||(u[z.stream]=new e.MediaStream),t(L,u[z.stream]),f.push([L,W,u[z.stream]])):(u.default||(u.default=new e.MediaStream),t(L,u.default),f.push([L,W,u.default]))):delete O.rtpReceiver}}),s._dtlsRole===void 0&&(s._dtlsRole=o.type==="offer"?"active":"passive"),s._remoteDescription={type:o.type,sdp:o.sdp},o.type==="offer"?s._updateSignalingState("have-remote-offer"):s._updateSignalingState("stable"),Object.keys(u).forEach(function(g){var m=u[g];if(m.getTracks().length){if(s.remoteStreams.indexOf(m)===-1){s.remoteStreams.push(m);var P=new Event("addstream");P.stream=m,e.setTimeout(function(){s._dispatchEvent("addstream",P)})}f.forEach(function(S){var y=S[0],B=S[1];m.id===S[2].id&&i(s,y,B,[m])})}}),f.forEach(function(g){g[2]||i(s,g[0],g[1],[])}),e.setTimeout(function(){!(s&&s.transceivers)||s.transceivers.forEach(function(g){g.iceTransport&&g.iceTransport.state==="new"&&g.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),g.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},a.prototype.close=function(){this.transceivers.forEach(function(o){o.iceTransport&&o.iceTransport.stop(),o.dtlsTransport&&o.dtlsTransport.stop(),o.rtpSender&&o.rtpSender.stop(),o.rtpReceiver&&o.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},a.prototype._updateSignalingState=function(o){this.signalingState=o;var s=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",s)},a.prototype._maybeFireNegotiationNeeded=function(){var o=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,e.setTimeout(function(){if(o.needNegotiation){o.needNegotiation=!1;var s=new Event("negotiationneeded");o._dispatchEvent("negotiationneeded",s)}},0))},a.prototype._updateIceConnectionState=function(){var o,s={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&!f.rejected&&s[f.iceTransport.state]++}),o="new",s.failed>0?o="failed":s.checking>0?o="checking":s.disconnected>0?o="disconnected":s.new>0?o="new":s.connected>0?o="connected":s.completed>0&&(o="completed"),o!==this.iceConnectionState){this.iceConnectionState=o;var u=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",u)}},a.prototype._updateConnectionState=function(){var o,s={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&f.dtlsTransport&&!f.rejected&&(s[f.iceTransport.state]++,s[f.dtlsTransport.state]++)}),s.connected+=s.completed,o="new",s.failed>0?o="failed":s.connecting>0?o="connecting":s.disconnected>0?o="disconnected":s.new>0?o="new":s.connected>0&&(o="connected"),o!==this.connectionState){this.connectionState=o;var u=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",u)}},a.prototype.createOffer=function(){var o=this;if(o._isClosed)return Promise.reject(te("InvalidStateError","Can not call createOffer after close"));var s=o.transceivers.filter(function(h){return h.kind==="audio"}).length,u=o.transceivers.filter(function(h){return h.kind==="video"}).length,f=arguments[0];if(f){if(f.mandatory||f.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");f.offerToReceiveAudio!==void 0&&(f.offerToReceiveAudio===!0?s=1:f.offerToReceiveAudio===!1?s=0:s=f.offerToReceiveAudio),f.offerToReceiveVideo!==void 0&&(f.offerToReceiveVideo===!0?u=1:f.offerToReceiveVideo===!1?u=0:u=f.offerToReceiveVideo)}for(o.transceivers.forEach(function(h){h.kind==="audio"?(s--,s<0&&(h.wantReceive=!1)):h.kind==="video"&&(u--,u<0&&(h.wantReceive=!1))});s>0||u>0;)s>0&&(o._createTransceiver("audio"),s--),u>0&&(o._createTransceiver("video"),u--);var d=w.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.transceivers.forEach(function(h,v){var k=h.track,g=h.kind,m=h.mid||w.generateIdentifier();h.mid=m,h.iceGatherer||(h.iceGatherer=o._createIceGatherer(v,o.usingBundle));var P=e.RTCRtpSender.getCapabilities(g);r<15019&&(P.codecs=P.codecs.filter(function(y){return y.name!=="rtx"})),P.codecs.forEach(function(y){y.name==="H264"&&y.parameters["level-asymmetry-allowed"]===void 0&&(y.parameters["level-asymmetry-allowed"]="1"),h.remoteCapabilities&&h.remoteCapabilities.codecs&&h.remoteCapabilities.codecs.forEach(function(B){y.name.toLowerCase()===B.name.toLowerCase()&&y.clockRate===B.clockRate&&(y.preferredPayloadType=B.payloadType)})}),P.headerExtensions.forEach(function(y){var B=h.remoteCapabilities&&h.remoteCapabilities.headerExtensions||[];B.forEach(function(x){y.uri===x.uri&&(y.id=x.id)})});var S=h.sendEncodingParameters||[{ssrc:(2*v+1)*1001}];k&&r>=15019&&g==="video"&&!S[0].rtx&&(S[0].rtx={ssrc:S[0].ssrc+1}),h.wantReceive&&(h.rtpReceiver=new e.RTCRtpReceiver(h.dtlsTransport,g)),h.localCapabilities=P,h.sendEncodingParameters=S}),o._config.bundlePolicy!=="max-compat"&&(d+="a=group:BUNDLE "+o.transceivers.map(function(h){return h.mid}).join(" ")+`\r
`),d+=`a=ice-options:trickle\r
`,o.transceivers.forEach(function(h,v){d+=ln(h,h.localCapabilities,"offer",h.stream,o._dtlsRole),d+=`a=rtcp-rsize\r
`,h.iceGatherer&&o.iceGatheringState!=="new"&&(v===0||!o.usingBundle)&&(h.iceGatherer.getLocalCandidates().forEach(function(k){k.component=1,d+="a="+w.writeCandidate(k)+`\r
`}),h.iceGatherer.state==="completed"&&(d+=`a=end-of-candidates\r
`))});var p=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(p)},a.prototype.createAnswer=function(){var o=this;if(o._isClosed)return Promise.reject(te("InvalidStateError","Can not call createAnswer after close"));if(!(o.signalingState==="have-remote-offer"||o.signalingState==="have-local-pranswer"))return Promise.reject(te("InvalidStateError","Can not call createAnswer in signalingState "+o.signalingState));var s=w.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.usingBundle&&(s+="a=group:BUNDLE "+o.transceivers.map(function(d){return d.mid}).join(" ")+`\r
`),s+=`a=ice-options:trickle\r
`;var u=w.getMediaSections(o._remoteDescription.sdp).length;o.transceivers.forEach(function(d,p){if(!(p+1>u)){if(d.rejected){d.kind==="application"?d.protocol==="DTLS/SCTP"?s+=`m=application 0 DTLS/SCTP 5000\r
`:s+="m=application 0 "+d.protocol+` webrtc-datachannel\r
`:d.kind==="audio"?s+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:d.kind==="video"&&(s+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),s+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+d.mid+`\r
`;return}if(d.stream){var h;d.kind==="audio"?h=d.stream.getAudioTracks()[0]:d.kind==="video"&&(h=d.stream.getVideoTracks()[0]),h&&r>=15019&&d.kind==="video"&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}var v=_t(d.localCapabilities,d.remoteCapabilities),k=v.codecs.filter(function(g){return g.name.toLowerCase()==="rtx"}).length;!k&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,s+=ln(d,v,"answer",d.stream,o._dtlsRole),d.rtcpParameters&&d.rtcpParameters.reducedSize&&(s+=`a=rtcp-rsize\r
`)}});var f=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(f)},a.prototype.addIceCandidate=function(o){var s=this,u;return o&&!(o.sdpMLineIndex!==void 0||o.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(f,d){if(s._remoteDescription)if(!o||o.candidate==="")for(var p=0;p<s.transceivers.length&&!(!s.transceivers[p].rejected&&(s.transceivers[p].iceTransport.addRemoteCandidate({}),u=w.getMediaSections(s._remoteDescription.sdp),u[p]+=`a=end-of-candidates\r
`,s._remoteDescription.sdp=w.getDescription(s._remoteDescription.sdp)+u.join(""),s.usingBundle));p++);else{var h=o.sdpMLineIndex;if(o.sdpMid){for(var v=0;v<s.transceivers.length;v++)if(s.transceivers[v].mid===o.sdpMid){h=v;break}}var k=s.transceivers[h];if(k){if(k.rejected)return f();var g=Object.keys(o.candidate).length>0?w.parseCandidate(o.candidate):{};if(g.protocol==="tcp"&&(g.port===0||g.port===9)||g.component&&g.component!==1)return f();if((h===0||h>0&&k.iceTransport!==s.transceivers[0].iceTransport)&&!sr(k.iceTransport,g))return d(te("OperationError","Can not add ICE candidate"));var m=o.candidate.trim();m.indexOf("a=")===0&&(m=m.substr(2)),u=w.getMediaSections(s._remoteDescription.sdp),u[h]+="a="+(g.type?m:"end-of-candidates")+`\r
`,s._remoteDescription.sdp=w.getDescription(s._remoteDescription.sdp)+u.join("")}else return d(te("OperationError","Can not add ICE candidate"))}else return d(te("InvalidStateError","Can not add ICE candidate without a remote description"));f()})},a.prototype.getStats=function(o){if(o&&o instanceof e.MediaStreamTrack){var s=null;if(this.transceivers.forEach(function(f){f.rtpSender&&f.rtpSender.track===o?s=f.rtpSender:f.rtpReceiver&&f.rtpReceiver.track===o&&(s=f.rtpReceiver)}),!s)throw te("InvalidAccessError","Invalid selector.");return s.getStats()}var u=[];return this.transceivers.forEach(function(f){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(d){f[d]&&u.push(f[d].getStats())})}),Promise.all(u).then(function(f){var d=new Map;return f.forEach(function(p){p.forEach(function(h){d.set(h.id,h)})}),d})};var c=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];c.forEach(function(o){var s=e[o];if(s&&s.prototype&&s.prototype.getStats){var u=s.prototype.getStats;s.prototype.getStats=function(){return u.apply(this).then(function(f){var d=new Map;return Object.keys(f).forEach(function(p){f[p].type=fo(f[p]),d.set(p,f[p])}),d})}}});var l=["createOffer","createAnswer"];return l.forEach(function(o){var s=a.prototype[o];a.prototype[o]=function(){var u=arguments;return typeof u[0]=="function"||typeof u[1]=="function"?s.apply(this,[arguments[2]]).then(function(f){typeof u[0]=="function"&&u[0].apply(null,[f])},function(f){typeof u[1]=="function"&&u[1].apply(null,[f])}):s.apply(this,arguments)}}),l=["setLocalDescription","setRemoteDescription","addIceCandidate"],l.forEach(function(o){var s=a.prototype[o];a.prototype[o]=function(){var u=arguments;return typeof u[1]=="function"||typeof u[2]=="function"?s.apply(this,arguments).then(function(){typeof u[1]=="function"&&u[1].apply(null)},function(f){typeof u[2]=="function"&&u[2].apply(null,[f])}):s.apply(this,arguments)}}),["getStats"].forEach(function(o){var s=a.prototype[o];a.prototype[o]=function(){var u=arguments;return typeof u[1]=="function"?s.apply(this,arguments).then(function(){typeof u[1]=="function"&&u[1].apply(null)}):s.apply(this,arguments)}}),a};function bi(e){const r=e&&e.navigator,t=function(i){return{name:{PermissionDeniedError:"NotAllowedError"}[i.name]||i.name,message:i.message,constraint:i.constraint,toString(){return this.name}}},n=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(i){return n(i).catch(a=>Promise.reject(t(a)))}}function _i(e){"getDisplayMedia"in e.navigator&&(!e.navigator.mediaDevices||e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function yr(e,r){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(i){return i}),e.RTCSessionDescription||(e.RTCSessionDescription=function(i){return i}),r.version<15025)){const n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(i){n.set.call(this,i);const a=new Event("enabled");a.enabled=i,this.dispatchEvent(a)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const t=ho(e,r.version);e.RTCPeerConnection=function(i){return i&&i.iceServers&&(i.iceServers=uo(i.iceServers,r.version),zr("ICE servers after filtering:",i.iceServers)),new t(i)},e.RTCPeerConnection.prototype=t.prototype}function Ci(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var fn=Object.freeze(Object.defineProperty({__proto__:null,shimPeerConnection:yr,shimReplaceTrack:Ci,shimGetUserMedia:bi,shimGetDisplayMedia:_i},Symbol.toStringTag,{value:"Module"}));function Si(e,r){const t=e&&e.navigator,n=e&&e.MediaStreamTrack;if(t.getUserMedia=function(i,a,c){Jt("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(a,c)},!(r.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(c,l,o){l in c&&!(o in c)&&(c[o]=c[l],delete c[l])},a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),i(c.audio,"autoGainControl","mozAutoGainControl"),i(c.audio,"noiseSuppression","mozNoiseSuppression")),a(c)},n&&n.prototype.getSettings){const c=n.prototype.getSettings;n.prototype.getSettings=function(){const l=c.apply(this,arguments);return i(l,"mozAutoGainControl","autoGainControl"),i(l,"mozNoiseSuppression","noiseSuppression"),l}}if(n&&n.prototype.applyConstraints){const c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),i(l,"autoGainControl","mozAutoGainControl"),i(l,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[l])}}}}function vo(e,r){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return n.video===!0?n.video={mediaSource:r}:n.video.mediaSource=r,e.navigator.mediaDevices.getUserMedia(n)})}function Ti(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function br(e,r){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=e.RTCPeerConnection.prototype[i],c={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=c[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[a,c,l]=arguments;return n.apply(this,[a||null]).then(o=>{if(r.version<53&&!c)try{o.forEach(s=>{s.type=t[s.type]||s.type})}catch(s){if(s.name!=="TypeError")throw s;o.forEach((u,f)=>{o.set(f,Object.assign({},u,{type:t[u.type]||u.type}))})}return o}).then(c,l)}}function ki(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(a=>a._pc=this),i});const t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Pi(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=r.apply(this,[]);return n.forEach(i=>i._pc=this),n}),Qe(e,"track",t=>(t.receiver._pc=t.srcElement,t)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function xi(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){Jt("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Ri(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Ei(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.addTransceiver;r&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const n=arguments[1],i=n&&"sendEncodings"in n;i&&n.sendEncodings.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=r.apply(this,arguments);if(i){const{sender:c}=a,l=c.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=n.sendEncodings,c.sendEncodings=n.sendEncodings,this.setParametersPromises.push(c.setParameters(l).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return a})}function Oi(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const r=e.RTCRtpSender.prototype.getParameters;r&&(e.RTCRtpSender.prototype.getParameters=function(){const n=r.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Di(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function Mi(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}var dn=Object.freeze(Object.defineProperty({__proto__:null,shimOnTrack:Ti,shimPeerConnection:br,shimSenderGetStats:ki,shimReceiverGetStats:Pi,shimRemoveStream:xi,shimRTCDataChannel:Ri,shimAddTransceiver:Ei,shimGetParameters:Oi,shimCreateOffer:Di,shimCreateAnswer:Mi,shimGetUserMedia:Si,shimGetDisplayMedia:vo},Symbol.toStringTag,{value:"Module"}));function Ai(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(i=>r.call(this,i,n)),n.getVideoTracks().forEach(i=>r.call(this,i,n))},e.RTCPeerConnection.prototype.addTrack=function(n,...i){return i&&i.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),r.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const i=t.getTracks();this.getSenders().forEach(a=>{i.includes(a.track)&&this.removeTrack(a)})})}}function Ii(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(a=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(a)>=0)return;n._remoteStreams.push(a);const c=new Event("addstream");c.stream=a,n.dispatchEvent(c)})}),r.apply(n,arguments)}}}function Bi(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,t=r.createOffer,n=r.createAnswer,i=r.setLocalDescription,a=r.setRemoteDescription,c=r.addIceCandidate;r.createOffer=function(s,u){const f=arguments.length>=2?arguments[2]:arguments[0],d=t.apply(this,[f]);return u?(d.then(s,u),Promise.resolve()):d},r.createAnswer=function(s,u){const f=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[f]);return u?(d.then(s,u),Promise.resolve()):d};let l=function(o,s,u){const f=i.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f};r.setLocalDescription=l,l=function(o,s,u){const f=a.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f},r.setRemoteDescription=l,l=function(o,s,u){const f=c.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f},r.addIceCandidate=l}function wi(e){const r=e&&e.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const t=r.mediaDevices,n=t.getUserMedia.bind(t);r.mediaDevices.getUserMedia=i=>n(Li(i))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(n,i,a){r.mediaDevices.getUserMedia(n).then(i,a)}.bind(r))}function Li(e){return e&&e.video!==void 0?Object.assign({},e,{video:li(e.video)}):e}function ji(e){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection;e.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const a=[];for(let c=0;c<n.iceServers.length;c++){let l=n.iceServers[c];!l.hasOwnProperty("urls")&&l.hasOwnProperty("url")?(Jt("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,a.push(l)):a.push(n.iceServers[c])}n.iceServers=a}return new r(n,i)},e.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function zi(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $i(e){const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio"),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const a=this.getTransceivers().find(c=>c.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video")}return r.apply(this,arguments)}}function Fi(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var pn=Object.freeze(Object.defineProperty({__proto__:null,shimLocalStreamsAPI:Ai,shimRemoteStreamsAPI:Ii,shimCallbacksAPI:Bi,shimGetUserMedia:wi,shimConstraints:Li,shimRTCIceServerUrls:ji,shimTrackEventTransceiver:zi,shimCreateOfferLegacy:$i,shimAudioContext:Fi},Symbol.toStringTag,{value:"Module"}));function Et(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const r=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const i=new r(n),a=Rt.parseCandidate(n.candidate),c=Object.assign(i,a);return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new r(n)},e.RTCIceCandidate.prototype=r.prototype,Qe(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function at(e,r){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(l){if(!l||!l.sdp)return!1;const o=Rt.splitSections(l.sdp);return o.shift(),o.some(s=>{const u=Rt.parseMLine(s);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},n=function(l){const o=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(o===null||o.length<2)return-1;const s=parseInt(o[1],10);return s!==s?-1:s},i=function(l){let o=65536;return r.browser==="firefox"&&(r.version<57?l===-1?o=16384:o=2147483637:r.version<60?o=r.version===57?65535:65536:o=2147483637),o},a=function(l,o){let s=65536;r.browser==="firefox"&&r.version===57&&(s=65535);const u=Rt.matchPrefix(l.sdp,"a=max-message-size:");return u.length>0?s=parseInt(u[0].substr(19),10):r.browser==="firefox"&&o!==-1&&(s=2147483637),s},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:o}=this.getConfiguration();o==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const o=n(arguments[0]),s=i(o),u=a(arguments[0],o);let f;s===0&&u===0?f=Number.POSITIVE_INFINITY:s===0||u===0?f=Math.max(s,u):f=Math.min(s,u);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return f}}),this._sctp=d}return c.apply(this,arguments)}}function ot(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function r(n,i){const a=n.send;n.send=function(){const l=arguments[0],o=l.length||l.size||l.byteLength;if(n.readyState==="open"&&i.sctp&&o>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(n,arguments)}}const t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return r(i,this),i},Qe(e,"datachannel",n=>(r(n.channel,n.target),n))}function _r(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=r[t];r[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const c=new Event("connectionstatechange",i);a.dispatchEvent(c)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Cr(e,r){if(!e.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r.version>=605)return;const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=i.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:a}):i.sdp=a}return t.apply(this,arguments)}}function Ot(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const t=e.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var mo=Object.freeze(Object.defineProperty({__proto__:null,shimRTCIceCandidate:Et,shimMaxMessageSize:at,shimSendThrowTypeError:ot,shimConnectionState:_r,removeExtmapAllowMixed:Cr,shimAddIceCandidateNullOrEmpty:Ot},Symbol.toStringTag,{value:"Module"}));function go({window:e}={},r={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const t=zr,n=co(e),i={browserDetails:n,commonShim:mo,extractVersion:it,disableLog:oo,disableWarnings:so};switch(n.browser){case"chrome":if(!cn||!gr||!r.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=cn,Ot(e,n),ui(e,n),fi(e),gr(e,n),di(e),gi(e,n),pi(e),hi(e),vi(e),yi(e,n),Et(e),_r(e),at(e,n),ot(e),Cr(e,n);break;case"firefox":if(!dn||!br||!r.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=dn,Ot(e,n),Si(e,n),br(e,n),Ti(e),xi(e),ki(e),Pi(e),Ri(e),Ei(e),Oi(e),Di(e),Mi(e),Et(e),_r(e),at(e,n),ot(e);break;case"edge":if(!fn||!yr||!r.shimEdge)return t("MS edge shim is not included in this adapter release."),i;t("adapter.js shimming edge."),i.browserShim=fn,bi(e),_i(e),yr(e,n),Ci(e),at(e,n),ot(e);break;case"safari":if(!pn||!r.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=pn,Ot(e,n),ji(e),$i(e),Bi(e),Ai(e),Ii(e),zi(e),wi(e),Fi(e),Et(e),at(e,n),ot(e),Cr(e,n);break;default:t("Unsupported browser!");break}return i}const hn=go({window:typeof window>"u"?void 0:window});function ke(e,r,t,n){Object.defineProperty(e,r,{get:t,set:n,enumerable:!0,configurable:!0})}var cr=hn.default||hn,Ze=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return typeof RTCPeerConnection<"u"},e.prototype.isBrowserSupported=function(){var r=this.getBrowser(),t=this.getVersion(),n=this.supportedBrowsers.includes(r);return n?r==="chrome"?t>=this.minChromeVersion:r==="firefox"?t>=this.minFirefoxVersion:r==="safari"?!this.isIOS&&t>=this.minSafariVersion:!1:!1},e.prototype.getBrowser=function(){return cr.browserDetails.browser},e.prototype.getVersion=function(){return cr.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var r=this.getBrowser(),t=cr.browserDetails.version||0;if(r==="chrome"&&t<this.minChromeVersion)return!1;if(r==="firefox"&&t>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var n,i=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),i=!0}catch{}finally{n&&n.close()}return i},e.prototype.toString=function(){return`Supports:
    browser:`.concat(this.getBrowser(),`
    version:`).concat(this.getVersion(),`
    isIOS:`).concat(this.isIOS,`
    isWebRTCSupported:`).concat(this.isWebRTCSupported(),`
    isBrowserSupported:`).concat(this.isBrowserSupported(),`
    isUnifiedPlanSupported:`).concat(this.isUnifiedPlanSupported())},e}()),vn={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},yo=function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=vn,this.browser=Ze.getBrowser(),this.browserVersion=Ze.getVersion(),this.supports=function(){var r={browser:Ze.isBrowserSupported(),webRTC:Ze.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!r.webRTC)return r;var t;try{t=new RTCPeerConnection(vn),r.audioVideo=!0;var n=void 0;try{n=t.createDataChannel("_PEERJSTEST",{ordered:!0}),r.data=!0,r.reliable=!!n.ordered;try{n.binaryType="blob",r.binaryBlob=!Ze.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{t&&t.close()}return r}(),this.pack=nn.pack,this.unpack=nn.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(r){return!r||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(r)},e.prototype.chunk=function(r){for(var t=[],n=r.size,i=Math.ceil(n/F.chunkedMTU),a=0,c=0;c<n;){var l=Math.min(n,c+F.chunkedMTU),o=r.slice(c,l),s={__peerData:this._dataCount,n:a,data:o,total:i};t.push(s),c=l,a++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(r,t){var n=new FileReader;return n.onload=function(i){i.target&&t(i.target.result)},n.readAsArrayBuffer(r),n},e.prototype.binaryStringToArrayBuffer=function(r){for(var t=new Uint8Array(r.length),n=0;n<r.length;n++)t[n]=r.charCodeAt(n)&255;return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).slice(2)},e.prototype.isSecure=function(){return location.protocol==="https:"},e}(),F=new yo,qi={};ke(qi,"Peer",()=>xn,e=>xn=e);var gt={},bo=Object.prototype.hasOwnProperty,oe="~";function dt(){}Object.create&&(dt.prototype=Object.create(null),new dt().__proto__||(oe=!1));function _o(e,r,t){this.fn=e,this.context=r,this.once=t||!1}function Ni(e,r,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var a=new _o(t,n||e,i),c=oe?oe+r:r;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function Dt(e,r){--e._eventsCount===0?e._events=new dt:delete e._events[r]}function re(){this._events=new dt,this._eventsCount=0}re.prototype.eventNames=function(){var r=[],t,n;if(this._eventsCount===0)return r;for(n in t=this._events)bo.call(t,n)&&r.push(oe?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r};re.prototype.listeners=function(r){var t=oe?oe+r:r,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,c=new Array(a);i<a;i++)c[i]=n[i].fn;return c};re.prototype.listenerCount=function(r){var t=oe?oe+r:r,n=this._events[t];return n?n.fn?1:n.length:0};re.prototype.emit=function(r,t,n,i,a,c){var l=oe?oe+r:r;if(!this._events[l])return!1;var o=this._events[l],s=arguments.length,u,f;if(o.fn){switch(o.once&&this.removeListener(r,o.fn,void 0,!0),s){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,t),!0;case 3:return o.fn.call(o.context,t,n),!0;case 4:return o.fn.call(o.context,t,n,i),!0;case 5:return o.fn.call(o.context,t,n,i,a),!0;case 6:return o.fn.call(o.context,t,n,i,a,c),!0}for(f=1,u=new Array(s-1);f<s;f++)u[f-1]=arguments[f];o.fn.apply(o.context,u)}else{var d=o.length,p;for(f=0;f<d;f++)switch(o[f].once&&this.removeListener(r,o[f].fn,void 0,!0),s){case 1:o[f].fn.call(o[f].context);break;case 2:o[f].fn.call(o[f].context,t);break;case 3:o[f].fn.call(o[f].context,t,n);break;case 4:o[f].fn.call(o[f].context,t,n,i);break;default:if(!u)for(p=1,u=new Array(s-1);p<s;p++)u[p-1]=arguments[p];o[f].fn.apply(o[f].context,u)}}return!0};re.prototype.on=function(r,t,n){return Ni(this,r,t,n,!1)};re.prototype.once=function(r,t,n){return Ni(this,r,t,n,!0)};re.prototype.removeListener=function(r,t,n,i){var a=oe?oe+r:r;if(!this._events[a])return this;if(!t)return Dt(this,a),this;var c=this._events[a];if(c.fn)c.fn===t&&(!i||c.once)&&(!n||c.context===n)&&Dt(this,a);else{for(var l=0,o=[],s=c.length;l<s;l++)(c[l].fn!==t||i&&!c[l].once||n&&c[l].context!==n)&&o.push(c[l]);o.length?this._events[a]=o.length===1?o[0]:o:Dt(this,a)}return this};re.prototype.removeAllListeners=function(r){var t;return r?(t=oe?oe+r:r,this._events[t]&&Dt(this,t)):(this._events=new dt,this._eventsCount=0),this};re.prototype.off=re.prototype.removeListener;re.prototype.addListener=re.prototype.on;re.prefixed=oe;re.EventEmitter=re;gt=re;var R={};ke(R,"LogLevel",()=>fe,e=>fe=e);ke(R,"default",()=>mn,e=>mn=e);var je=function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,a=[],c;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){c={error:l}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(c)throw c.error}}return a},ze=function(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))},Co="PeerJS: ",fe;(function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"})(fe||(fe={}));var So=function(){function e(){this._logLevel=fe.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(r){this._logLevel=r},enumerable:!1,configurable:!0}),e.prototype.log=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=fe.All&&this._print.apply(this,ze([fe.All],je(r),!1))},e.prototype.warn=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=fe.Warnings&&this._print.apply(this,ze([fe.Warnings],je(r),!1))},e.prototype.error=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=fe.Errors&&this._print.apply(this,ze([fe.Errors],je(r),!1))},e.prototype.setLogFunction=function(r){this._print=r},e.prototype._print=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=ze([Co],je(t),!1);for(var a in i)i[a]instanceof Error&&(i[a]="("+i[a].name+") "+i[a].message);r>=fe.All?console.log.apply(console,ze([],je(i),!1)):r>=fe.Warnings?console.warn.apply(console,ze(["WARNING"],je(i),!1)):r>=fe.Errors&&console.error.apply(console,ze(["ERROR"],je(i),!1))},e}(),mn=new So,Ui={};ke(Ui,"Socket",()=>gn,e=>gn=e);var _e;(function(e){e.Data="data",e.Media="media"})(_e||(_e={}));var V;(function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"})(V||(V={}));var xe;(function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"})(xe||(xe={}));var Re;(function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"})(Re||(Re={}));var J;(function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"})(J||(J={}));var Fr={};Fr=JSON.parse('{"name":"peerjs","version":"1.4.7","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz St\xFCckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","So\u0308ren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","types":"dist/types.d.ts","engines":{"node":">= 10"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts","format":"prettier --write .","semantic-release":"semantic-release"},"devDependencies":{"@parcel/config-default":"^2.5.0","@parcel/packager-ts":"^2.5.0","@parcel/transformer-typescript-tsc":"^2.5.0","@parcel/transformer-typescript-types":"^2.5.0","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@types/chai":"^4.3.0","@types/mocha":"^9.1.0","@types/node":"^17.0.18","chai":"^4.3.6","git-authors-cli":"^1.0.40","jsdom":"^19.0.0","jsdom-global":"^3.0.2","mocha":"^9.2.0","mock-socket":"8.0.5","parcel":"^2.5.0","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","semantic-release":"^19.0.2","standard":"^16.0.4","ts-node":"^10.5.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.3.13","eventemitter3":"^4.0.7","peerjs-js-binarypack":"1.0.1","webrtc-adapter":"^7.7.1"}}');var To=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ko=function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,a=[],c;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){c={error:l}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(c)throw c.error}}return a},Po=function(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))},xo=function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},gn=function(e){To(r,e);function r(t,n,i,a,c,l){l===void 0&&(l=5e3);var o=e.call(this)||this;o.pingInterval=l,o._disconnected=!0,o._messagesQueue=[];var s=t?"wss://":"ws://";return o._baseUrl=s+n+":"+i+a+"peerjs?key="+c,o}return r.prototype.start=function(t,n){var i=this;this._id=t;var a="".concat(this._baseUrl,"&id=").concat(t,"&token=").concat(n);!!this._socket||!this._disconnected||(this._socket=new WebSocket(a+"&version="+Fr.version),this._disconnected=!1,this._socket.onmessage=function(c){var l;try{l=JSON.parse(c.data),R.default.log("Server message received:",l)}catch{R.default.log("Invalid server message",c.data);return}i.emit(Re.Message,l)},this._socket.onclose=function(c){i._disconnected||(R.default.log("Socket closed.",c),i._cleanup(),i._disconnected=!0,i.emit(Re.Disconnected))},this._socket.onopen=function(){i._disconnected||(i._sendQueuedMessages(),R.default.log("Socket open"),i._scheduleHeartbeat())})},r.prototype._scheduleHeartbeat=function(){var t=this;this._wsPingTimer=setTimeout(function(){t._sendHeartbeat()},this.pingInterval)},r.prototype._sendHeartbeat=function(){if(!this._wsOpen()){R.default.log("Cannot send heartbeat, because socket closed");return}var t=JSON.stringify({type:J.Heartbeat});this._socket.send(t),this._scheduleHeartbeat()},r.prototype._wsOpen=function(){return!!this._socket&&this._socket.readyState===1},r.prototype._sendQueuedMessages=function(){var t,n,i=Po([],ko(this._messagesQueue),!1);this._messagesQueue=[];try{for(var a=xo(i),c=a.next();!c.done;c=a.next()){var l=c.value;this.send(l)}}catch(o){t={error:o}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},r.prototype.send=function(t){if(!this._disconnected){if(!this._id){this._messagesQueue.push(t);return}if(!t.type){this.emit(Re.Error,"Invalid message");return}if(!!this._wsOpen()){var n=JSON.stringify(t);this._socket.send(n)}}},r.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},r.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},r}(gt.EventEmitter),Sr={};ke(Sr,"MediaConnection",()=>_n,e=>_n=e);var qr={};ke(qr,"Negotiator",()=>yn,e=>yn=e);var zt=function(){return zt=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},zt.apply(this,arguments)},Ct=function(e,r,t,n){function i(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function l(u){try{s(n.next(u))}catch(f){c(f)}}function o(u){try{s(n.throw(u))}catch(f){c(f)}}function s(u){u.done?a(u.value):i(u.value).then(l,o)}s((n=n.apply(e,r||[])).next())})},St=function(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(s){return function(u){return o([s,u])}}function o(s){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,i=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){t.label=s[1];break}if(s[0]===6&&t.label<a[1]){t.label=a[1],a=s;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(s);break}a[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(u){s=[6,u],i=0}finally{n=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},yn=function(){function e(r){this.connection=r}return e.prototype.startConnection=function(r){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===_e.Media&&r._stream&&this._addTracksToConnection(r._stream,t),r.originator){if(this.connection.type===_e.Data){var n=this.connection,i={ordered:!!r.reliable},a=t.createDataChannel(n.label,i);n.initialize(a)}this._makeOffer()}else this.handleSDP("OFFER",r.sdp)},e.prototype._startPeerConnection=function(){R.default.log("Creating RTCPeerConnection.");var r=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(r),r},e.prototype._setupListeners=function(r){var t=this,n=this.connection.peer,i=this.connection.connectionId,a=this.connection.type,c=this.connection.provider;R.default.log("Listening for ICE candidates."),r.onicecandidate=function(l){!l.candidate||!l.candidate.candidate||(R.default.log("Received ICE candidates for ".concat(n,":"),l.candidate),c.socket.send({type:J.Candidate,payload:{candidate:l.candidate,type:a,connectionId:i},dst:n}))},r.oniceconnectionstatechange=function(){switch(r.iceConnectionState){case"failed":R.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit("error",new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":R.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit("error",new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":R.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":r.onicecandidate=F.noop;break}t.connection.emit("iceStateChanged",r.iceConnectionState)},R.default.log("Listening for data channel"),r.ondatachannel=function(l){R.default.log("Received data channel");var o=l.channel,s=c.getConnection(n,i);s.initialize(o)},R.default.log("Listening for remote stream"),r.ontrack=function(l){R.default.log("Received remote stream");var o=l.streams[0],s=c.getConnection(n,i);if(s.type===_e.Media){var u=s;t._addStreamToMediaConnection(o,u)}}},e.prototype.cleanup=function(){R.default.log("Cleaning up PeerConnection to "+this.connection.peer);var r=this.connection.peerConnection;if(!!r){this.connection.peerConnection=null,r.onicecandidate=r.oniceconnectionstatechange=r.ondatachannel=r.ontrack=function(){};var t=r.signalingState!=="closed",n=!1;if(this.connection.type===_e.Data){var i=this.connection,a=i.dataChannel;a&&(n=!!a.readyState&&a.readyState!=="closed")}(t||n)&&r.close()}},e.prototype._makeOffer=function(){return Ct(this,void 0,Promise,function(){var r,t,n,i,a,c,l;return St(this,function(o){switch(o.label){case 0:r=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,r.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),R.default.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,r.setLocalDescription(n)];case 4:return o.sent(),R.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:F.browser},this.connection.type===_e.Data&&(a=this.connection,i=zt(zt({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:J.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return c=o.sent(),c!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(V.WebRTC,c),R.default.log("Failed to setLocalDescription, ",c)),[3,6];case 6:return[3,8];case 7:return l=o.sent(),t.emitError(V.WebRTC,l),R.default.log("Failed to createOffer, ",l),[3,8];case 8:return[2]}})})},e.prototype._makeAnswer=function(){return Ct(this,void 0,Promise,function(){var r,t,n,i,a;return St(this,function(c){switch(c.label){case 0:r=this.connection.peerConnection,t=this.connection.provider,c.label=1;case 1:return c.trys.push([1,7,,8]),[4,r.createAnswer()];case 2:n=c.sent(),R.default.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,r.setLocalDescription(n)];case 4:return c.sent(),R.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),t.socket.send({type:J.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:F.browser},dst:this.connection.peer}),[3,6];case 5:return i=c.sent(),t.emitError(V.WebRTC,i),R.default.log("Failed to setLocalDescription, ",i),[3,6];case 6:return[3,8];case 7:return a=c.sent(),t.emitError(V.WebRTC,a),R.default.log("Failed to create answer, ",a),[3,8];case 8:return[2]}})})},e.prototype.handleSDP=function(r,t){return Ct(this,void 0,Promise,function(){var n,i,a,c;return St(this,function(l){switch(l.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,i=this.connection.provider,R.default.log("Setting remote description",t),a=this,l.label=1;case 1:return l.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return l.sent(),R.default.log("Set remoteDescription:".concat(r," for:").concat(this.connection.peer)),r!=="OFFER"?[3,4]:[4,a._makeAnswer()];case 3:l.sent(),l.label=4;case 4:return[3,6];case 5:return c=l.sent(),i.emitError(V.WebRTC,c),R.default.log("Failed to setRemoteDescription, ",c),[3,6];case 6:return[2]}})})},e.prototype.handleCandidate=function(r){return Ct(this,void 0,Promise,function(){var t,n,i,a,c,l;return St(this,function(o){switch(o.label){case 0:R.default.log("handleCandidate:",r),t=r.candidate,n=r.sdpMLineIndex,i=r.sdpMid,a=this.connection.peerConnection,c=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),R.default.log("Added ICE candidate for:".concat(this.connection.peer)),[3,4];case 3:return l=o.sent(),c.emitError(V.WebRTC,l),R.default.log("Failed to handleCandidate, ",l),[3,4];case 4:return[2]}})})},e.prototype._addTracksToConnection=function(r,t){if(R.default.log("add tracks from stream ".concat(r.id," to peer connection")),!t.addTrack)return R.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");r.getTracks().forEach(function(n){t.addTrack(n,r)})},e.prototype._addStreamToMediaConnection=function(r,t){R.default.log("add stream ".concat(r.id," to media connection ").concat(t.connectionId)),t.addStream(r)},e}(),Nr={};ke(Nr,"BaseConnection",()=>bn,e=>bn=e);var Ro=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bn=function(e){Ro(r,e);function r(t,n,i){var a=e.call(this)||this;return a.peer=t,a.provider=n,a.options=i,a._open=!1,a.metadata=i.metadata,a}return Object.defineProperty(r.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),r}(gt.EventEmitter),Eo=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$t=function(){return $t=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},$t.apply(this,arguments)},Oo=function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},_n=function(e){Eo(r,e);function r(t,n,i){var a=e.call(this,t,n,i)||this;return a._localStream=a.options._stream,a.connectionId=a.options.connectionId||r.ID_PREFIX+F.randomToken(),a._negotiator=new qr.Negotiator(a),a._localStream&&a._negotiator.startConnection({_stream:a._localStream,originator:!0}),a}return Object.defineProperty(r.prototype,"type",{get:function(){return _e.Media},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),r.prototype.addStream=function(t){R.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,"stream",t)},r.prototype.handleMessage=function(t){var n=t.type,i=t.payload;switch(t.type){case J.Answer:this._negotiator.handleSDP(n,i.sdp),this._open=!0;break;case J.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:R.default.warn("Unrecognized message type:".concat(n," from peer:").concat(this.peer));break}},r.prototype.answer=function(t,n){var i,a;if(n===void 0&&(n={}),this._localStream){R.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=t,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection($t($t({},this.options._payload),{_stream:t}));var c=this.provider._getMessages(this.connectionId);try{for(var l=Oo(c),o=l.next();!o.done;o=l.next()){var s=o.value;this.handleMessage(s)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}this._open=!0},r.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},r.ID_PREFIX="mc_",r}(Nr.BaseConnection),Tr={};ke(Tr,"DataConnection",()=>Sn,e=>Sn=e);var Hi={};ke(Hi,"EncodingQueue",()=>Cn,e=>Cn=e);var Do=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Cn=function(e){Do(r,e);function r(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(n){t._processing=!1,n.target&&t.emit("done",n.target.result),t.doNextTask()},t.fileReader.onerror=function(n){R.default.error("EncodingQueue error:",n),t._processing=!1,t.destroy(),t.emit("error",n)},t}return Object.defineProperty(r.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),r.prototype.enque=function(t){this.queue.push(t),!this.processing&&this.doNextTask()},r.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},r.prototype.doNextTask=function(){this.size!==0&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},r}(gt.EventEmitter),Mo=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ao=function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},Sn=function(e){Mo(r,e);function r(t,n,i){var a=e.call(this,t,n,i)||this;return a.stringify=JSON.stringify,a.parse=JSON.parse,a._buffer=[],a._bufferSize=0,a._buffering=!1,a._chunkedData={},a._encodingQueue=new Hi.EncodingQueue,a.connectionId=a.options.connectionId||r.ID_PREFIX+F.randomToken(),a.label=a.options.label||a.connectionId,a.serialization=a.options.serialization||xe.Binary,a.reliable=!!a.options.reliable,a._encodingQueue.on("done",function(c){a._bufferedSend(c)}),a._encodingQueue.on("error",function(){R.default.error("DC#".concat(a.connectionId,": Error occured in encoding from blob to arraybuffer, close DC")),a.close()}),a._negotiator=new qr.Negotiator(a),a._negotiator.startConnection(a.options._payload||{originator:!0}),a}return Object.defineProperty(r.prototype,"type",{get:function(){return _e.Data},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),r.prototype.initialize=function(t){this._dc=t,this._configureDataChannel()},r.prototype._configureDataChannel=function(){var t=this;(!F.supports.binaryBlob||F.supports.reliable)&&(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){R.default.log("DC#".concat(t.connectionId," dc connection success")),t._open=!0,t.emit("open")},this.dataChannel.onmessage=function(n){R.default.log("DC#".concat(t.connectionId," dc onmessage:"),n.data),t._handleDataMessage(n)},this.dataChannel.onclose=function(){R.default.log("DC#".concat(t.connectionId," dc closed for:"),t.peer),t.close()}},r.prototype._handleDataMessage=function(t){var n=this,i=t.data,a=i.constructor,c=this.serialization===xe.Binary||this.serialization===xe.BinaryUTF8,l=i;if(c){if(a===Blob){F.blobToArrayBuffer(i,function(s){var u=F.unpack(s);n.emit("data",u)});return}else if(a===ArrayBuffer)l=F.unpack(i);else if(a===String){var o=F.binaryStringToArrayBuffer(i);l=F.unpack(o)}}else this.serialization===xe.JSON&&(l=this.parse(i));if(l.__peerData){this._handleChunk(l);return}e.prototype.emit.call(this,"data",l)},r.prototype._handleChunk=function(t){var n=t.__peerData,i=this._chunkedData[n]||{data:[],count:0,total:t.total};if(i.data[t.n]=t.data,i.count++,this._chunkedData[n]=i,i.total===i.count){delete this._chunkedData[n];var a=new Blob(i.data);this._handleDataMessage({data:a})}},r.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},r.prototype.send=function(t,n){if(!this.open){e.prototype.emit.call(this,"error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));return}if(this.serialization===xe.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===xe.Binary||this.serialization===xe.BinaryUTF8){var i=F.pack(t);if(!n&&i.size>F.chunkedMTU){this._sendChunks(i);return}F.supports.binaryBlob?this._bufferedSend(i):this._encodingQueue.enque(i)}else this._bufferedSend(t)},r.prototype._bufferedSend=function(t){(this._buffering||!this._trySend(t))&&(this._buffer.push(t),this._bufferSize=this._buffer.length)},r.prototype._trySend=function(t){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>r.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){n._buffering=!1,n._tryBuffer()},50),!1;try{this.dataChannel.send(t)}catch(i){return R.default.error("DC#:".concat(this.connectionId," Error when sending:"),i),this._buffering=!0,this.close(),!1}return!0},r.prototype._tryBuffer=function(){if(!!this.open&&this._buffer.length!==0){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},r.prototype._sendChunks=function(t){var n,i,a=F.chunk(t);R.default.log("DC#".concat(this.connectionId," Try to send ").concat(a.length," chunks..."));try{for(var c=Ao(a),l=c.next();!l.done;l=c.next()){var o=l.value;this.send(o,!0)}}catch(s){n={error:s}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}},r.prototype.handleMessage=function(t){var n=t.payload;switch(t.type){case J.Answer:this._negotiator.handleSDP(t.type,n.sdp);break;case J.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:R.default.warn("Unrecognized message type:",t.type,"from peer:",this.peer);break}},r.ID_PREFIX="dc_",r.MAX_BUFFERED_AMOUNT=8388608,r}(Nr.BaseConnection),Gi={};ke(Gi,"API",()=>Pn,e=>Pn=e);var Tn=function(e,r,t,n){function i(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function l(u){try{s(n.next(u))}catch(f){c(f)}}function o(u){try{s(n.throw(u))}catch(f){c(f)}}function s(u){u.done?a(u.value):i(u.value).then(l,o)}s((n=n.apply(e,r||[])).next())})},kn=function(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(s){return function(u){return o([s,u])}}function o(s){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,i=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){t.label=s[1];break}if(s[0]===6&&t.label<a[1]){t.label=a[1],a=s;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(s);break}a[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(u){s=[6,u],i=0}finally{n=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Pn=function(){function e(r){this._options=r}return e.prototype._buildRequest=function(r){var t=this._options.secure?"https":"http",n=this._options,i=n.host,a=n.port,c=n.path,l=n.key,o=new URL("".concat(t,"://").concat(i,":").concat(a).concat(c).concat(l,"/").concat(r));return o.searchParams.set("ts","".concat(Date.now()).concat(Math.random())),o.searchParams.set("version",Fr.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})},e.prototype.retrieveId=function(){return Tn(this,void 0,Promise,function(){var r,t,n;return kn(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this._buildRequest("id")];case 1:if(r=i.sent(),r.status!==200)throw new Error("Error. Status:".concat(r.status));return[2,r.text()];case 2:throw t=i.sent(),R.default.error("Error retrieving ID",t),n="",this._options.path==="/"&&this._options.host!==F.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n);case 3:return[2]}})})},e.prototype.listAllPeers=function(){return Tn(this,void 0,Promise,function(){var r,t,n;return kn(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this._buildRequest("peers")];case 1:if(r=i.sent(),r.status!==200)throw r.status===401?(t="",this._options.host===F.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)):new Error("Error. Status:".concat(r.status));return[2,r.json()];case 2:throw n=i.sent(),R.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 3:return[2]}})})},e}(),Io=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ut=function(){return ut=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ut.apply(this,arguments)},et=function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},Bo=function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,a=[],c;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){c={error:l}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(c)throw c.error}}return a},xn=function(e){Io(r,e);function r(t,n){var i=e.call(this)||this;i._id=null,i._lastServerId=null,i._destroyed=!1,i._disconnected=!1,i._open=!1,i._connections=new Map,i._lostMessages=new Map;var a;return t&&t.constructor==Object?n=t:t&&(a=t.toString()),n=ut({debug:0,host:F.CLOUD_HOST,port:F.CLOUD_PORT,path:"/",key:r.DEFAULT_KEY,token:F.randomToken(),config:F.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin"},n),i._options=n,i._options.host==="/"&&(i._options.host=window.location.hostname),i._options.path&&(i._options.path[0]!=="/"&&(i._options.path="/"+i._options.path),i._options.path[i._options.path.length-1]!=="/"&&(i._options.path+="/")),i._options.secure===void 0&&i._options.host!==F.CLOUD_HOST?i._options.secure=F.isSecure():i._options.host==F.CLOUD_HOST&&(i._options.secure=!0),i._options.logFunction&&R.default.setLogFunction(i._options.logFunction),R.default.logLevel=i._options.debug||0,i._api=new Gi.API(n),i._socket=i._createServerConnection(),!F.supports.audioVideo&&!F.supports.data?(i._delayedAbort(V.BrowserIncompatible,"The current browser does not support WebRTC"),i):!!a&&!F.validateId(a)?(i._delayedAbort(V.InvalidID,'ID "'.concat(a,'" is invalid')),i):(a?i._initialize(a):i._api.retrieveId().then(function(c){return i._initialize(c)}).catch(function(c){return i._abort(V.ServerError,c)}),i)}return Object.defineProperty(r.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"connections",{get:function(){var t,n,i=Object.create(null);try{for(var a=et(this._connections),c=a.next();!c.done;c=a.next()){var l=Bo(c.value,2),o=l[0],s=l[1];i[o]=s}}catch(u){t={error:u}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),r.prototype._createServerConnection=function(){var t=this,n=new Ui.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return n.on(Re.Message,function(i){t._handleMessage(i)}),n.on(Re.Error,function(i){t._abort(V.SocketError,i)}),n.on(Re.Disconnected,function(){t.disconnected||(t.emitError(V.Network,"Lost connection to server."),t.disconnect())}),n.on(Re.Close,function(){t.disconnected||t._abort(V.SocketClosed,"Underlying socket is already closed.")}),n},r.prototype._initialize=function(t){this._id=t,this.socket.start(t,this._options.token)},r.prototype._handleMessage=function(t){var n,i,a=t.type,c=t.payload,l=t.src;switch(a){case J.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case J.Error:this._abort(V.ServerError,c.msg);break;case J.IdTaken:this._abort(V.UnavailableID,'ID "'.concat(this.id,'" is taken'));break;case J.InvalidKey:this._abort(V.InvalidKey,'API KEY "'.concat(this._options.key,'" is invalid'));break;case J.Leave:R.default.log("Received leave message from ".concat(l)),this._cleanupPeer(l),this._connections.delete(l);break;case J.Expire:this.emitError(V.PeerUnavailable,"Could not connect to peer ".concat(l));break;case J.Offer:var h=c.connectionId,v=this.getConnection(l,h);if(v&&(v.close(),R.default.warn("Offer received for existing Connection ID:".concat(h))),c.type===_e.Media){var o=new Sr.MediaConnection(l,this,{connectionId:h,_payload:c,metadata:c.metadata});v=o,this._addConnection(l,v),this.emit("call",o)}else if(c.type===_e.Data){var s=new Tr.DataConnection(l,this,{connectionId:h,_payload:c,metadata:c.metadata,label:c.label,serialization:c.serialization,reliable:c.reliable});v=s,this._addConnection(l,v),this.emit("connection",s)}else{R.default.warn("Received malformed connection type:".concat(c.type));return}var u=this._getMessages(h);try{for(var f=et(u),d=f.next();!d.done;d=f.next()){var p=d.value;v.handleMessage(p)}}catch(k){n={error:k}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}break;default:if(!c){R.default.warn("You received a malformed message from ".concat(l," of type ").concat(a));return}var h=c.connectionId,v=this.getConnection(l,h);v&&v.peerConnection?v.handleMessage(t):h?this._storeMessage(h,t):R.default.warn("You received an unrecognized message:",t);break}},r.prototype._storeMessage=function(t,n){this._lostMessages.has(t)||this._lostMessages.set(t,[]),this._lostMessages.get(t).push(n)},r.prototype._getMessages=function(t){var n=this._lostMessages.get(t);return n?(this._lostMessages.delete(t),n):[]},r.prototype.connect=function(t,n){if(n===void 0&&(n={}),this.disconnected){R.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(V.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}var i=new Tr.DataConnection(t,this,n);return this._addConnection(t,i),i},r.prototype.call=function(t,n,i){if(i===void 0&&(i={}),this.disconnected){R.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(V.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){R.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}var a=new Sr.MediaConnection(t,this,ut(ut({},i),{_stream:n}));return this._addConnection(t,a),a},r.prototype._addConnection=function(t,n){R.default.log("add connection ".concat(n.type,":").concat(n.connectionId," to peerId:").concat(t)),this._connections.has(t)||this._connections.set(t,[]),this._connections.get(t).push(n)},r.prototype._removeConnection=function(t){var n=this._connections.get(t.peer);if(n){var i=n.indexOf(t);i!==-1&&n.splice(i,1)}this._lostMessages.delete(t.connectionId)},r.prototype.getConnection=function(t,n){var i,a,c=this._connections.get(t);if(!c)return null;try{for(var l=et(c),o=l.next();!o.done;o=l.next()){var s=o.value;if(s.connectionId===n)return s}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return null},r.prototype._delayedAbort=function(t,n){var i=this;setTimeout(function(){i._abort(t,n)},0)},r.prototype._abort=function(t,n){R.default.error("Aborting!"),this.emitError(t,n),this._lastServerId?this.disconnect():this.destroy()},r.prototype.emitError=function(t,n){R.default.error("Error:",n);var i;typeof n=="string"?i=new Error(n):i=n,i.type=t,this.emit("error",i)},r.prototype.destroy=function(){this.destroyed||(R.default.log("Destroy peer with ID:".concat(this.id)),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))},r.prototype._cleanup=function(){var t,n;try{for(var i=et(this._connections.keys()),a=i.next();!a.done;a=i.next()){var c=a.value;this._cleanupPeer(c),this._connections.delete(c)}}catch(l){t={error:l}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.socket.removeAllListeners()},r.prototype._cleanupPeer=function(t){var n,i,a=this._connections.get(t);if(!!a)try{for(var c=et(a),l=c.next();!l.done;l=c.next()){var o=l.value;o.close()}}catch(s){n={error:s}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}},r.prototype.disconnect=function(){if(!this.disconnected){var t=this.id;R.default.log("Disconnect peer with ID:".concat(t)),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=t,this._id=null,this.emit("disconnected",t)}},r.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)R.default.log("Attempting reconnection to server with ID ".concat(this._lastServerId)),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)R.default.error("In a hurry? We're still trying to make the initial connection!");else throw new Error("Peer ".concat(this.id," cannot reconnect because it is not disconnected from the server!"))}},r.prototype.listAllPeers=function(t){var n=this;t===void 0&&(t=function(i){}),this._api.listAllPeers().then(function(i){return t(i)}).catch(function(i){return n._abort(V.ServerError,i)})},r.DEFAULT_KEY="peerjs",r}(gt.EventEmitter),wo=qi.Peer;const Lo=[M("circle",{cx:"15",cy:"15",r:"15"},[M("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),M("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),M("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[M("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),M("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),M("circle",{cx:"105",cy:"15",r:"15"},[M("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),M("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var jo=K({name:"QSpinnerDots",props:Ca,setup(e){const{cSize:r,classes:t}=Sa(e);return()=>M("svg",{class:t.value,fill:"currentColor",width:r.value,height:r.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},Lo)}});const{passive:$e}=Ne;var zo=K({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:{default:void 0},initialIndex:Number,disable:Boolean,reverse:Boolean},emits:["load"],setup(e,{slots:r,emit:t}){const n=A(!1),i=A(!0),a=A(null),c=A(null);let l=e.initialIndex||0,o,s;const u=b(()=>"q-infinite-scroll__loading"+(n.value===!0?"":" invisible"));function f(){if(e.disable===!0||n.value===!0||i.value===!1)return;const x=bt(o),z=kt(o),N=Wr(o);e.reverse===!1?Math.round(z+N+e.offset)>=Math.round(x)&&d():Math.round(z)<=e.offset&&d()}function d(){if(e.disable===!0||n.value===!0||i.value===!1)return;l++,n.value=!0;const x=bt(o);t("load",l,z=>{i.value===!0&&(n.value=!1,Le(()=>{if(e.reverse===!0){const N=bt(o),O=kt(o),U=N-x;ct(o,O+U)}z===!0?v():a.value&&a.value.closest("body")&&s()}))})}function p(){l=0}function h(){i.value===!1&&(i.value=!0,o.addEventListener("scroll",s,$e)),f()}function v(){i.value===!0&&(i.value=!1,n.value=!1,o.removeEventListener("scroll",s,$e),s!==void 0&&s.cancel!==void 0&&s.cancel())}function k(){if(o&&i.value===!0&&o.removeEventListener("scroll",s,$e),o=Qt(a.value,e.scrollTarget),i.value===!0){if(o.addEventListener("scroll",s,$e),e.reverse===!0){const x=bt(o),z=Wr(o);ct(o,x-z)}f()}}function g(x){l=x}function m(x){x=parseInt(x,10);const z=s;s=x<=0?f:Gn(f,isNaN(x)===!0?100:x),o&&i.value===!0&&(z!==void 0&&o.removeEventListener("scroll",z,$e),o.addEventListener("scroll",s,$e))}function P(x){if(S.value===!0){if(c.value===null){x!==!0&&Le(()=>{P(!0)});return}const z=`${n.value===!0?"un":""}pauseAnimations`;Array.from(c.value.getElementsByTagName("svg")).forEach(N=>{N[z]()})}}const S=b(()=>e.disable!==!0&&i.value===!0);j([n,S],()=>{P()}),j(()=>e.disable,x=>{x===!0?v():h()}),j(()=>e.reverse,()=>{n.value===!1&&i.value===!0&&f()}),j(()=>e.scrollTarget,k),j(()=>e.debounce,m);let y=!1;Un(()=>{y!==!1&&o&&ct(o,y)}),Hn(()=>{y=o?kt(o):!1}),de(()=>{i.value===!0&&o.removeEventListener("scroll",s,$e)}),we(()=>{m(e.debounce),k(),n.value===!1&&P()});const B=se();return Object.assign(B.proxy,{poll:()=>{s!==void 0&&s()},trigger:d,stop:v,reset:p,resume:h,setIndex:g}),()=>{const x=Br(r.default,[]);return S.value===!0&&x[e.reverse===!1?"push":"unshift"](M("div",{ref:c,class:u.value},Te(r.loading))),M("div",{class:"q-infinite-scroll",ref:a},x)}}});const Rn=["vertical","horizontal"],lr={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},En={prevent:!0,mouse:!0,mouseAllDir:!0},On=e=>e>=250?50:Math.ceil(e/5);var Vi=K({name:"QScrollArea",props:{...ht,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:r,emit:t}){const n=A(!1),i=A(!1),a=A(!1),c={vertical:A(0),horizontal:A(0)},l={vertical:{ref:A(null),position:A(0),size:A(0)},horizontal:{ref:A(null),position:A(0),size:A(0)}},{proxy:o}=se(),s=vt(e,o.$q);let u=null,f;const d=A(null),p=b(()=>"q-scrollarea"+(s.value===!0?" q-scrollarea--dark":""));l.vertical.percentage=b(()=>{const C=l.vertical.size.value-c.vertical.value;if(C<=0)return 0;const I=Be(l.vertical.position.value/C,0,1);return Math.round(I*1e4)/1e4}),l.vertical.thumbHidden=b(()=>(e.visible===null?a.value:e.visible)!==!0&&n.value===!1&&i.value===!1||l.vertical.size.value<=c.vertical.value+1),l.vertical.thumbStart=b(()=>l.vertical.percentage.value*(c.vertical.value-l.vertical.thumbSize.value)),l.vertical.thumbSize=b(()=>Math.round(Be(c.vertical.value*c.vertical.value/l.vertical.size.value,On(c.vertical.value),c.vertical.value))),l.vertical.style=b(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${l.vertical.thumbStart.value}px`,height:`${l.vertical.thumbSize.value}px`})),l.vertical.thumbClass=b(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(l.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),l.vertical.barClass=b(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(l.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),l.horizontal.percentage=b(()=>{const C=l.horizontal.size.value-c.horizontal.value;if(C<=0)return 0;const I=Be(Math.abs(l.horizontal.position.value)/C,0,1);return Math.round(I*1e4)/1e4}),l.horizontal.thumbHidden=b(()=>(e.visible===null?a.value:e.visible)!==!0&&n.value===!1&&i.value===!1||l.horizontal.size.value<=c.horizontal.value+1),l.horizontal.thumbStart=b(()=>l.horizontal.percentage.value*(c.horizontal.value-l.horizontal.thumbSize.value)),l.horizontal.thumbSize=b(()=>Math.round(Be(c.horizontal.value*c.horizontal.value/l.horizontal.size.value,On(c.horizontal.value),c.horizontal.value))),l.horizontal.style=b(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[o.$q.lang.rtl===!0?"right":"left"]:`${l.horizontal.thumbStart.value}px`,width:`${l.horizontal.thumbSize.value}px`})),l.horizontal.thumbClass=b(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(l.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),l.horizontal.barClass=b(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(l.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const h=b(()=>l.vertical.thumbHidden.value===!0&&l.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle),v=[[lt,C=>{x(C,"vertical")},void 0,{vertical:!0,...En}]],k=[[lt,C=>{x(C,"horizontal")},void 0,{horizontal:!0,...En}]];function g(){const C={};return Rn.forEach(I=>{const L=l[I];C[I+"Position"]=L.position.value,C[I+"Percentage"]=L.percentage.value,C[I+"Size"]=L.size.value,C[I+"ContainerSize"]=c[I].value}),C}const m=Gn(()=>{const C=g();C.ref=o,t("scroll",C)},0);function P(C,I,L){if(Rn.includes(C)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(C==="vertical"?ct:ir)(d.value,I,L)}function S({height:C,width:I}){let L=!1;c.vertical.value!==C&&(c.vertical.value=C,L=!0),c.horizontal.value!==I&&(c.horizontal.value=I,L=!0),L===!0&&U()}function y({position:C}){let I=!1;l.vertical.position.value!==C.top&&(l.vertical.position.value=C.top,I=!0),l.horizontal.position.value!==C.left&&(l.horizontal.position.value=C.left,I=!0),I===!0&&U()}function B({height:C,width:I}){l.horizontal.size.value!==I&&(l.horizontal.size.value=I,U()),l.vertical.size.value!==C&&(l.vertical.size.value=C,U())}function x(C,I){const L=l[I];if(C.isFirst===!0){if(L.thumbHidden.value===!0)return;f=L.position.value,i.value=!0}else if(i.value!==!0)return;C.isFinal===!0&&(i.value=!1);const H=lr[I],ce=c[I].value,ge=(L.size.value-ce)/(ce-L.thumbSize.value),ye=C.distance[H.dist],q=f+(C.direction===H.dir?1:-1)*ye*ge;ne(q,I)}function z(C,I){const L=l[I];if(L.thumbHidden.value!==!0){const H=C[lr[I].offset];if(H<L.thumbStart.value||H>L.thumbStart.value+L.thumbSize.value){const ce=H-L.thumbSize.value/2;ne(ce/c[I].value*L.size.value,I)}L.ref.value!==null&&L.ref.value.dispatchEvent(new MouseEvent(C.type,C))}}function N(C){z(C,"vertical")}function O(C){z(C,"horizontal")}function U(){n.value=!0,u!==null&&clearTimeout(u),u=setTimeout(()=>{u=null,n.value=!1},e.delay),e.onScroll!==void 0&&m()}function ne(C,I){d.value[lr[I].scroll]=C}function Q(){a.value=!0}function W(){a.value=!1}let Z=null;return j(()=>o.$q.lang.rtl,C=>{d.value!==null&&ir(d.value,Math.abs(l.horizontal.position.value)*(C===!0?-1:1))}),Hn(()=>{Z={top:l.vertical.position.value,left:l.horizontal.position.value}}),Un(()=>{if(Z===null)return;const C=d.value;C!==null&&(ir(C,Z.left),ct(C,Z.top))}),de(m.cancel),Object.assign(o,{getScrollTarget:()=>d.value,getScroll:g,getScrollPosition:()=>({top:l.vertical.position.value,left:l.horizontal.position.value}),getScrollPercentage:()=>({top:l.vertical.percentage.value,left:l.horizontal.percentage.value}),setScrollPosition:P,setScrollPercentage(C,I,L){P(C,I*(l[C].size.value-c[C].value)*(C==="horizontal"&&o.$q.lang.rtl===!0?-1:1),L)}}),()=>M("div",{class:p.value,onMouseenter:Q,onMouseleave:W},[M("div",{ref:d,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[M("div",{class:"q-scrollarea__content absolute",style:h.value},Ir(r.default,[M(We,{debounce:0,onResize:B})])),M(oi,{axis:"both",onScroll:y})]),M(We,{debounce:0,onResize:S}),M("div",{class:l.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:N}),M("div",{class:l.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:O}),hr(M("div",{ref:l.vertical.ref,class:l.vertical.thumbClass.value,style:l.vertical.style.value,"aria-hidden":"true"}),v),hr(M("div",{ref:l.horizontal.ref,class:l.horizontal.thumbClass.value,style:l.horizontal.style.value,"aria-hidden":"true"}),k)])}});const $o=()=>!0;function Fo(e){const r={};return e.forEach(t=>{r[t]=$o}),r}function Ft(){const{emit:e,proxy:r}=se(),t=A(null);function n(){t.value.show()}function i(){t.value.hide()}function a(l){e("ok",l),i()}function c(){e("hide")}return Object.assign(r,{show:n,hide:i}),{dialogRef:t,onDialogHide:c,onDialogOK:a,onDialogCancel:i}}const Wi=["ok","hide"];Ft.emits=Wi;Ft.emitsObject=Fo(Wi);function Ee(e,r,t){return parseInt(e.substr(r,t),16)}function Ki(e){return e|=0,e<0?"00":e<16?"0"+e.toString(16):e<256?e.toString(16):"ff"}function ur(e,r,t){return t=t<0?t+6:t>6?t-6:t,Ki(255*(t<1?e+(r-e)*t:t<3?r:t<4?e+(r-e)*(4-t):e))}function qo(e){if(/^#[0-9a-f]{3,8}$/i.test(e)){let r;const t=e.length;if(t<6){const n=e[1],i=e[2],a=e[3],c=e[4]||"";r="#"+n+n+i+i+a+a+c+c}return(t==7||t>8)&&(r=e),r}}function Dn(e){const r=Ee(e,7,2);let t;if(isNaN(r))t=e;else{const n=Ee(e,1,2),i=Ee(e,3,2),a=Ee(e,5,2);t="rgba("+n+","+i+","+a+","+(r/255).toFixed(2)+")"}return t}function No(e,r,t){let n;if(r==0){const i=Ki(t*255);n=i+i+i}else{const i=t<=.5?t*(r+1):t+r-t*r,a=t*2-i;n=ur(a,i,e*6+2)+ur(a,i,e*6)+ur(a,i,e*6-2)}return"#"+n}function tt(e,r,t){const n=[.55,.5,.5,.46,.6,.55,.55],i=n[e*6+.5|0];return t=t<.5?t*i*2:i+(t-.5)*(1-i)*2,No(e,r,t)}const Uo=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{},Mn={V:"jdenticon_config",n:"config"};var Ho={};function Go(e,r){const t=typeof e=="object"&&e||Ho[Mn.n]||Uo[Mn.V]||{},n=t.lightness||{},i=t.saturation||{},a="color"in i?i.color:i,c=i.grayscale,l=t.backColor,o=t.padding;function s(f,d){let p=n[f];return p&&p.length>1||(p=d),function(h){return h=p[0]+h*(p[1]-p[0]),h<0?0:h>1?1:h}}function u(f){const d=t.hues;let p;return d&&d.length>0&&(p=d[0|.999*f*d.length]),typeof p=="number"?(p/360%1+1)%1:f}return{W:u,o:typeof a=="number"?a:.5,D:typeof c=="number"?c:0,p:s("color",[.4,.8]),F:s("grayscale",[.3,.9]),G:qo(l),X:typeof e=="number"?e:typeof o=="number"?o:r}}class Tt{constructor(r,t){this.x=r,this.y=t}}class Qi{constructor(r,t,n,i){this.q=r,this.t=t,this.H=n,this.Y=i}I(r,t,n,i){const a=this.q+this.H,c=this.t+this.H,l=this.Y;return l===1?new Tt(a-t-(i||0),this.t+r):l===2?new Tt(a-r-(n||0),c-t-(i||0)):l===3?new Tt(this.q+t,c-r-(n||0)):new Tt(this.q+r,this.t+t)}}const Vo=new Qi(0,0,0,0);class Wo{constructor(r){this.J=r,this.u=Vo}g(r,t){const n=t?-2:2,i=[];for(let a=t?r.length-2:0;a<r.length&&a>=0;a+=n)i.push(this.u.I(r[a],r[a+1]));this.J.g(i)}h(r,t,n,i){const a=this.u.I(r,t,n,n);this.J.h(a,n,i)}i(r,t,n,i,a){this.g([r,t,r+n,t,r+n,t+i,r,t+i],a)}j(r,t,n,i,a,c){const l=[r+n,t,r+n,t+i,r,t+i,r,t];l.splice((a||0)%4*2,2),this.g(l,c)}K(r,t,n,i,a){this.g([r+n/2,t,r+n,t+i/2,r+n/2,t+i,r,t+i/2],a)}}function Ko(e,r,t,n){e=e%14;let i,a,c,l,o,s;e?e==1?(c=0|t*.5,l=0|t*.8,r.j(t-c,0,c,l,2)):e==2?(c=0|t/3,r.i(c,c,t-c,t-c)):e==3?(o=t*.1,s=t<6?1:t<8?2:0|t*.25,o=o>1?0|o:o>.5?1:o,r.i(s,s,t-o-s,t-o-s)):e==4?(a=0|t*.15,c=0|t*.5,r.h(t-c-a,t-c-a,c)):e==5?(o=t*.1,s=o*4,s>3&&(s=0|s),r.i(0,0,t,t),r.g([s,s,t-o,s,s+(t-s-o)/2,t-o],!0)):e==6?r.g([0,0,t,0,t,t*.7,t*.4,t*.4,t*.7,t,0,t]):e==7?r.j(t/2,t/2,t/2,t/2,3):e==8?(r.i(0,0,t,t/2),r.i(0,t/2,t/2,t/2),r.j(t/2,t/2,t/2,t/2,1)):e==9?(o=t*.14,s=t<4?1:t<6?2:0|t*.35,o=t<8?o:0|o,r.i(0,0,t,t),r.i(s,s,t-s-o,t-s-o,!0)):e==10?(o=t*.12,s=o*3,r.i(0,0,t,t),r.h(s,s,t-o-s,!0)):e==11?r.j(t/2,t/2,t/2,t/2,3):e==12?(a=t*.25,r.i(0,0,t,t),r.K(a,a,t-a,t-a,!0)):!n&&(a=t*.4,c=t*1.2,r.h(a,a,c)):(i=t*.42,r.g([0,0,t,0,t,t-i*2,t-i,t,0,t]))}function An(e,r,t){e=e%4;let n;e?e==1?r.j(0,t/2,t,t/2,0):e==2?r.K(0,0,t,t):(n=t/6,r.h(n,n,t-2*n)):r.j(0,0,t,t,0)}function Qo(e,r){return e=r.W(e),[tt(e,r.D,r.F(0)),tt(e,r.o,r.p(.5)),tt(e,r.D,r.F(1)),tt(e,r.o,r.p(1)),tt(e,r.o,r.p(0))]}function Jo(e,r,t){const n=Go(t,.08);n.G&&e.m(n.G);let i=e.k;const a=.5+i*n.X|0;i-=a*2;const c=new Wo(e),l=0|i/4,o=0|a+i/2-l*2,s=0|a+i/2-l*2;function u(k,g,m,P,S){const y=Ee(r,m,1);let B=P?Ee(r,P,1):0;e.L(d[p[k]]);for(let x=0;x<S.length;x++)c.u=new Qi(o+S[x][0]*l,s+S[x][1]*l,l,B++%4),g(y,c,l,x);e.M()}const f=Ee(r,-7)/268435455,d=Qo(f,n),p=[];let h;function v(k){if(k.indexOf(h)>=0){for(let g=0;g<k.length;g++)if(p.indexOf(k[g])>=0)return!0}}for(let k=0;k<3;k++)h=Ee(r,8+k,1)%d.length,(v([0,4])||v([2,3]))&&(h=1),p.push(h);u(0,An,2,3,[[1,0],[2,0],[2,3],[1,3],[0,1],[3,1],[3,2],[0,2]]),u(1,An,4,5,[[0,0],[3,0],[3,3],[0,3]]),u(2,Ko,1,null,[[1,1],[2,1],[2,2],[1,2]]),e.finish()}function Yo(e){var n=0,i=0,a=encodeURI(e)+"%80",c=[],l,o=[],s=1732584193,u=4023233417,f=~s,d=~u,p=3285377520,h=[s,u,f,d,p],v=0,k="";function g(m,P){return m<<P|m>>>32-P}for(;n<a.length;i++)c[i>>2]=c[i>>2]|(a[n]=="%"?parseInt(a.substring(n+1,n+=3),16):a.charCodeAt(n++))<<(3-(i&3))*8;for(l=((i+7>>6)+1)*16,c[l-1]=i*8-8;v<l;v+=16){for(n=0;n<80;n++)i=g(s,5)+p+(n<20?(u&f^~u&d)+1518500249:n<40?(u^f^d)+1859775393:n<60?(u&f^u&d^f&d)+2400959708:(u^f^d)+3395469782)+(o[n]=n<16?c[v+n]|0:g(o[n-3]^o[n-8]^o[n-14]^o[n-16],1)),p=d,d=f,f=g(u,30),u=s,s=i;h[0]=s=h[0]+s|0,h[1]=u=h[1]+u|0,h[2]=f=h[2]+f|0,h[3]=d=h[3]+d|0,h[4]=p=h[4]+p|0}for(n=0;n<40;n++)k+=(h[n>>3]>>>(7-(n&7))*4&15).toString(16);return k}function In(e){return/^[0-9a-f]{11,}$/i.test(e)&&e}function Bn(e){return Yo(e==null?"":""+e)}class Xo{constructor(r,t){const n=r.canvas,i=n.width,a=n.height;r.save(),t||(t=Math.min(i,a),r.translate((i-t)/2|0,(a-t)/2|0)),this.l=r,this.k=t,r.clearRect(0,0,t,t)}m(r){const t=this.l,n=this.k;t.fillStyle=Dn(r),t.fillRect(0,0,n,n)}L(r){const t=this.l;t.fillStyle=Dn(r),t.beginPath()}M(){this.l.fill()}g(r){const t=this.l;t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath()}h(r,t,n){const i=this.l,a=t/2;i.moveTo(r.x+a,r.y+a),i.arc(r.x+a,r.y+a,a,0,Math.PI*2,n),i.closePath()}finish(){this.l.restore()}}function Ue(e){return(e*10+.5|0)/10}class Zo{constructor(){this.v=""}g(r){let t="";for(let n=0;n<r.length;n++)t+=(n?"L":"M")+Ue(r[n].x)+" "+Ue(r[n].y);this.v+=t+"Z"}h(r,t,n){const i=n?0:1,a=Ue(t/2),c=Ue(t),l="a"+a+","+a+" 0 1,"+i+" ";this.v+="M"+Ue(r.x)+" "+Ue(r.y+t/2)+l+c+",0"+l+-c+",0"}}class es{constructor(r){this.A,this.B={},this.N=r,this.k=r.k}m(r){const t=/^(#......)(..)?/.exec(r),n=t[2]?Ee(t[2],0)/255:1;this.N.m(t[1],n)}L(r){this.A=this.B[r]||(this.B[r]=new Zo)}M(){}g(r){this.A.g(r)}h(r,t,n){this.A.h(r,t,n)}finish(){const r=this.B;for(let t in r)r.hasOwnProperty(t)&&this.N.O(t,r[t].v)}}const st={P:"http://www.w3.org/2000/svg",R:"width",S:"height"},Ji=1,ts=2,fr={Z:"data-jdenticon-hash",T:"data-jdenticon-value"},wn=typeof document<"u"&&document.querySelectorAll.bind(document);function rs(e){if(e){const r=e.tagName;if(/^svg$/i.test(r))return Ji;if(/^canvas$/i.test(r)&&"getContext"in e)return ts}}function Ln(e,r,...t){const n=document.createElementNS(st.P,r);for(let i=0;i+1<t.length;i+=2)n.setAttribute(t[i],t[i+1]);e.appendChild(n)}class ns{constructor(r){const t=this.k=Math.min(Number(r.getAttribute(st.R))||100,Number(r.getAttribute(st.S))||100);for(this.U=r;r.firstChild;)r.removeChild(r.firstChild);r.setAttribute("viewBox","0 0 "+t+" "+t),r.setAttribute("preserveAspectRatio","xMidYMid meet")}m(r,t){t&&Ln(this.U,"rect",st.R,"100%",st.S,"100%","fill",r,"opacity",t)}O(r,t){Ln(this.U,"path","fill",r,"d",t)}}function is(e,r,t){Yi(e,r,t,function(n,i){if(i)return i==Ji?new es(new ns(n)):new Xo(n.getContext("2d"))})}function Yi(e,r,t,n){if(typeof e=="string"){if(wn){const c=wn(e);for(let l=0;l<c.length;l++)Yi(c[l],r,t,n)}return}const i=In(r)||r!=null&&Bn(r)||In(e.getAttribute(fr.Z))||e.hasAttribute(fr.T)&&Bn(e.getAttribute(fr.T));if(!i)return;const a=n(e,rs(e));a&&Jo(a,i,t)}const Ur=Ke({__name:"JdentIcon",props:{hash:null},setup(e){const r=e,t=A();return we(()=>is(t.value,r.hash)),(n,i)=>(G(),Ce("svg",{class:"jdent-icon",ref_key:"svgRef",ref:t},null,512))}});const as=Ve("div",{class:"text-h6"},"Chose your Username and Avatar",-1),os=Ve("div",{class:"text-caption"}," Your avatar is coupled to your peer ID so it cannot be changed later. ",-1),ss={class:"icon-flex-container"},cs={class:"row justify-center"},ls=Ke({__name:"AvatarPicker",emits:{...Ft.emitsObject},setup(e){const{dialogRef:r,onDialogOK:t,onDialogHide:n}=Ft(),i=A([]),a=A(),c=A("");function l(u){return Promise.all([...Array(u)].map(ds))}const o=async(u,f)=>{const d=await l(12);i.value.push(...d),f()};async function s(u){if(a.value?.resetValidation(),await Le(),!await a.value?.validate()){a.value?.focus();return}t({keyPair:u,username:c.value})}return(u,f)=>(G(),ve(Ta,{ref_key:"dialogRef",ref:r,onHide:be(n),class:"avatar-picker"},{default:E(()=>[T(ka,{style:{width:"700px","max-width":"650px","max-height":"90vh"}},{default:E(()=>[T(ar,null,{default:E(()=>[as,os]),_:1}),T(ar,null,{default:E(()=>[T(wr,{outlined:"",ref_key:"usernameRef",ref:a,modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=d=>c.value=d),label:"Username",autofocus:!0,rules:[Boolean]},null,8,["modelValue"])]),_:1}),T(ar,{class:"q-pt-sm"},{default:E(()=>[T(Vi,{style:{height:"340px"},visible:"",class:"scroll-blur"},{default:E(()=>[T(zo,{offset:750,onLoad:o},{loading:E(()=>[Ve("div",cs,[T(jo,{color:"primary",size:"lg"})])]),default:E(()=>[Ve("div",ss,[(G(!0),Ce(Wn,null,Vn(i.value,d=>(G(),ve(Ur,{key:d.serializedPublicKey,hash:d.serializedPublicKey,onClick:p=>s(d)},null,8,["hash","onClick"]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}}),Yt=Na("username",""),Xt={name:"RSA-OAEP",hash:"SHA-256"},Xi=Symbol();let Mt=localStorage.getItem("publicKey"),At=localStorage.getItem("privateKey");if(!Mt||!At){const e=await fs();Yt.value=e.username,Mt=e.keyPair.serializedPublicKey,At=e.keyPair[Xi],localStorage.setItem("publicKey",Mt),localStorage.setItem("privateKey",At)}const us=await Zi(At,"private"),kr=Mt;function fs(){return new Promise(e=>{Pa.create({component:ls,componentProps:{persistent:!0}}).onOk(e)})}async function ds(){const e=await crypto.subtle.generateKey({...Xt,modulusLength:2048,publicExponent:new Uint8Array([1,0,1])},!0,["encrypt","decrypt"]),[r,t]=await Promise.all([jn(e.publicKey),jn(e.privateKey)]);return{pair:e,serializedPublicKey:r,[Xi]:t}}async function jn(e){const r=e.type==="public"?"spki":"pkcs8",t=await crypto.subtle.exportKey(r,e);return eo(t)}async function Zi(e,r){const t=r==="public"?"spki":"pkcs8",n=r==="public"?["encrypt"]:["decrypt"],i=to(e);return await crypto.subtle.importKey(t,i,Xt,!0,n)}async function ea(e){const r=await Zi(e,"public"),t=crypto.getRandomValues(new Uint8Array(100)).buffer,n=await crypto.subtle.encrypt(Xt,r,t);return{riddle:[...new Uint8Array(n)],solution:[...new Uint8Array(t)]}}async function ta(e){const r=new Uint8Array(e),t=await crypto.subtle.decrypt(Xt,us,r);return[...new Uint8Array(t)]}const qt=new wo(kr,{debug:0,secure:!0});await new Promise((e,r)=>{qt.once("open",e),qt.once("error",r)});async function ps(e){await new Promise(r=>setTimeout(r,e))}async function zn(e){const{riddle:r,solution:t}=await ea(e.id),n={username:Yt.value,callerRiddle:r},i=qt.connect(e.id,{metadata:n});return Kn(i),i.once("data",async a=>{const c=a;if(e.verification="pending",ra(c.calleeAnswer,t)!=="verified"){i.close(),console.error("Contact could not authenticate itself.",i),e.verification="untrusted";return}const o={callerAnswer:await ta(c.calleeRiddle)};i.send(o),i.once("data",s=>{const u=s;u?.message==="Hello my friend"&&(e.verification="verified",e.status="friend",e.username=u.username)})}),i.on("open",()=>{e.connected=!0}),i.on("close",()=>{e.connected=!1}),i.on("iceStateChanged",a=>{a==="disconnected"&&(e.connected=!1)}),i}qt.on("connection",async e=>{const r=Fe.value.find(t=>t.id===e.peer);try{r&&(r.verification="pending"),await hs(e),r&&(r.verification="verified")}catch(t){console.error(t),r&&(r.verification="untrusted"),e.close();return}if(r?.status==="outgoing friend request"){const t=e.metadata;r.status="friend",r.username=t.username}if(r?.status==="friend"){Kn(e),r.connection=e,r.connected=!0;return}if(e.close(),!r){Fe.value=[await Hr(e.peer,"incoming friend request",e.metadata.username),...Fe.value];return}});async function hs(e){const r=e.metadata,t=await ta(r.callerRiddle),{riddle:n,solution:i}=await ea(e.peer),a={calleeAnswer:t,calleeRiddle:n};await ps(500),e.send(a),await new Promise((c,l)=>{e.once("data",o=>{if(ra(o.callerAnswer,i)!=="verified"){e.close(),console.error("Contact could not authenticate itself.",e),l();return}const f={message:"Hello my friend",username:Yt.value};e.send(f),c()})})}function ra(e,r){return Array.isArray(e)&&e.length===r.length&&e.every((t,n)=>t===r[n])?"verified":"untrusted"}async function Hr(e,r,t){const n=rt({id:e,status:r,username:t??`${e.slice(0,5)}..${e.slice(-5)}`,connected:!1,highlight:!1,verification:"pending",connection:void 0,remove:i,acceptFriendRequest:a});(r==="friend"||r==="outgoing friend request")&&(n.connection=await zn(n));function i(){n.connection?.close(),pt.value=pt.value.filter(c=>c.id!==e)}async function a(){n.status="friend",n.connection=await zn(n)}return n}const pt=A(await vs()),Fe=pt;j(pt,ms,{deep:!0});async function vs(){const e=localStorage.getItem("contacts")??"[]",r=JSON.parse(e);return await Promise.all(r.map(({id:t,status:n,username:i})=>Hr(t,n,i)))}function ms(){const e=pt.value.map(t=>({id:t.id,status:t.status,username:t.username})),r=JSON.stringify(e);localStorage.setItem("contacts",r)}const gs=Ke({__name:"AddFriendInput",setup(e){const r=A("");function t(){setTimeout(()=>{r.value=""},0)}async function n(i){if(i.endsWith(jt)){t();const a=Fe.value.find(c=>c.id===i);if(a){a.highlight=!0,setTimeout(()=>a.highlight=!1,150);return}Fe.value=[await Hr(i,"outgoing friend request"),...Fe.value]}}return(i,a)=>(G(),ve(wr,{rounded:"",outlined:"",dense:"",class:"WAL__field full-width",modelValue:r.value,"onUpdate:modelValue":[a[0]||(a[0]=c=>r.value=c),a[1]||(a[1]=c=>n(c))],placeholder:"Paste your friend's peer ID"},{prepend:E(()=>[T(nt,{name:"person_add",class:"q-mr-xs"})]),_:1},8,["modelValue"]))}});var he=K({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:r}){const t=b(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>M("div",{class:t.value},Te(r.default))}}),ft=K({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:r}){const t=b(()=>parseInt(e.lines,10)),n=b(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(t.value===1?" ellipsis":"")),i=b(()=>e.lines!==void 0&&t.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":t.value}:null);return()=>M("div",{style:i.value,class:n.value},Te(r.default))}}),Ae=K({name:"QItem",props:{...ht,...xa,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:r,emit:t}){const{proxy:{$q:n}}=se(),i=vt(e,n),{hasLink:a,linkAttrs:c,linkClass:l,linkTag:o,navigateOnClick:s}=Ra(),u=A(null),f=A(null),d=b(()=>e.clickable===!0||a.value===!0||e.tag==="label"),p=b(()=>e.disable!==!0&&d.value===!0),h=b(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(i.value===!0?" q-item--dark":"")+(a.value===!0&&e.active===null?l.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(p.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),v=b(()=>{if(e.insetLevel===void 0)return null;const P=n.lang.rtl===!0?"Right":"Left";return{["padding"+P]:16+e.insetLevel*56+"px"}});function k(P){p.value===!0&&(f.value!==null&&(P.qKeyEvent!==!0&&document.activeElement===u.value?f.value.focus():document.activeElement===f.value&&u.value.focus()),s(P))}function g(P){if(p.value===!0&&Qn(P,13)===!0){Wt(P),P.qKeyEvent=!0;const S=new MouseEvent("click",P);S.qKeyEvent=!0,u.value.dispatchEvent(S)}t("keyup",P)}function m(){const P=Br(r.default,[]);return p.value===!0&&P.unshift(M("div",{class:"q-focus-helper",tabindex:-1,ref:f})),P}return()=>{const P={ref:u,class:h.value,style:v.value,role:"listitem",onClick:k,onKeyup:g};return p.value===!0?(P.tabindex=e.tabindex||"0",Object.assign(P,c.value)):d.value===!0&&(P["aria-disabled"]="true"),M(o.value,P,m())}}}),Pr=K({name:"QList",props:{...ht,bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},setup(e,{slots:r}){const t=se(),n=vt(e,t.proxy.$q),i=b(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(n.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>M(e.tag,{class:i.value},Te(r.default))}});const na={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function ia({showing:e,avoidEmit:r,configureAnchorEl:t}){const{props:n,proxy:i,emit:a}=se(),c=A(null);let l=null;function o(p){return c.value===null?!1:p===void 0||p.touches===void 0||p.touches.length<=1}const s={};t===void 0&&(Object.assign(s,{hide(p){i.hide(p)},toggle(p){i.toggle(p),p.qAnchorHandled=!0},toggleKey(p){Qn(p,13)===!0&&s.toggle(p)},contextClick(p){i.hide(p),It(p),Le(()=>{i.show(p),p.qAnchorHandled=!0})},prevent:It,mobileTouch(p){if(s.mobileCleanup(p),o(p)!==!0)return;i.hide(p),c.value.classList.add("non-selectable");const h=p.target;Ie(s,"anchor",[[h,"touchmove","mobileCleanup","passive"],[h,"touchend","mobileCleanup","passive"],[h,"touchcancel","mobileCleanup","passive"],[c.value,"contextmenu","prevent","notPassive"]]),l=setTimeout(()=>{l=null,i.show(p),p.qAnchorHandled=!0},300)},mobileCleanup(p){c.value.classList.remove("non-selectable"),l!==null&&(clearTimeout(l),l=null),e.value===!0&&p!==void 0&&Lt()}}),t=function(p=n.contextMenu){if(n.noParentEvent===!0||c.value===null)return;let h;p===!0?i.$q.platform.is.mobile===!0?h=[[c.value,"touchstart","mobileTouch","passive"]]:h=[[c.value,"mousedown","hide","passive"],[c.value,"contextmenu","contextClick","notPassive"]]:h=[[c.value,"click","toggle","passive"],[c.value,"keyup","toggleKey","passive"]],Ie(s,"anchor",h)});function u(){Ge(s,"anchor")}function f(p){for(c.value=p;c.value.classList.contains("q-anchor--skip");)c.value=c.value.parentNode;t()}function d(){if(n.target===!1||n.target===""||i.$el.parentNode===null)c.value=null;else if(n.target===!0)f(i.$el.parentNode);else{let p=n.target;if(typeof n.target=="string")try{p=document.querySelector(n.target)}catch{p=void 0}p!=null?(c.value=p.$el||p,t()):(c.value=null,console.error(`Anchor: target "${n.target}" not found`))}}return j(()=>n.contextMenu,p=>{c.value!==null&&(u(),t(p))}),j(()=>n.target,()=>{c.value!==null&&u(),d()}),j(()=>n.noParentEvent,p=>{c.value!==null&&(p===!0?u():t())}),we(()=>{d(),r!==!0&&n.modelValue===!0&&c.value===null&&a("update:modelValue",!1)}),de(()=>{l!==null&&clearTimeout(l),u()}),{anchorEl:c,canShow:o,anchorEvents:s}}function aa(e,r){const t=A(null);let n;function i(l,o){const s=`${o!==void 0?"add":"remove"}EventListener`,u=o!==void 0?o:n;l!==window&&l[s]("scroll",u,Ne.passive),window[s]("scroll",u,Ne.passive),n=o}function a(){t.value!==null&&(i(t.value),t.value=null)}const c=j(()=>e.noParentEvent,()=>{t.value!==null&&(a(),r())});return de(c),{localScrollTarget:t,unconfigureScrollTarget:a,changeScrollEvent:i}}const{notPassiveCapture:Nt}=Ne,qe=[];function Ut(e){const r=e.target;if(r===void 0||r.nodeType===8||r.classList.contains("no-pointer-events")===!0)return;let t=Kr.length-1;for(;t>=0;){const n=Kr[t].$;if(n.type.name!=="QDialog")break;if(n.props.seamless!==!0)return;t--}for(let n=qe.length-1;n>=0;n--){const i=qe[n];if((i.anchorEl.value===null||i.anchorEl.value.contains(r)===!1)&&(r===document.body||i.innerRef.value!==null&&i.innerRef.value.contains(r)===!1))e.qClickOutside=!0,i.onClickOutside(e);else return}}function oa(e){qe.push(e),qe.length===1&&(document.addEventListener("mousedown",Ut,Nt),document.addEventListener("touchstart",Ut,Nt))}function Ht(e){const r=qe.findIndex(t=>t===e);r>-1&&(qe.splice(r,1),qe.length===0&&(document.removeEventListener("mousedown",Ut,Nt),document.removeEventListener("touchstart",Ut,Nt)))}let $n,Fn;function Gt(e){const r=e.split(" ");return r.length!==2?!1:["top","center","bottom"].includes(r[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(r[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function sa(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const xr={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{xr[`${e}#ltr`]=e,xr[`${e}#rtl`]=e});function Vt(e,r){const t=e.split(" ");return{vertical:t[0],horizontal:xr[`${t[1]}#${r===!0?"rtl":"ltr"}`]}}function ys(e,r){let{top:t,left:n,right:i,bottom:a,width:c,height:l}=e.getBoundingClientRect();return r!==void 0&&(t-=r[1],n-=r[0],a+=r[1],i+=r[0],c+=r[0],l+=r[1]),{top:t,bottom:a,height:l,left:n,right:i,width:c,middle:n+(i-n)/2,center:t+(a-t)/2}}function bs(e,r,t){let{top:n,left:i}=e.getBoundingClientRect();return n+=r.top,i+=r.left,t!==void 0&&(n+=t[1],i+=t[0]),{top:n,bottom:n+1,height:1,left:i,right:i+1,width:1,middle:i,center:n}}function _s(e){return{top:0,center:e.offsetHeight/2,bottom:e.offsetHeight,left:0,middle:e.offsetWidth/2,right:e.offsetWidth}}function qn(e,r,t){return{top:e[t.anchorOrigin.vertical]-r[t.selfOrigin.vertical],left:e[t.anchorOrigin.horizontal]-r[t.selfOrigin.horizontal]}}function ca(e){if(He.is.ios===!0&&window.visualViewport!==void 0){const l=document.body.style,{offsetLeft:o,offsetTop:s}=window.visualViewport;o!==$n&&(l.setProperty("--q-pe-left",o+"px"),$n=o),s!==Fn&&(l.setProperty("--q-pe-top",s+"px"),Fn=s)}const{scrollLeft:r,scrollTop:t}=e.el,n=e.absoluteOffset===void 0?ys(e.anchorEl,e.cover===!0?[0,0]:e.offset):bs(e.anchorEl,e.absoluteOffset,e.offset);let i={maxHeight:e.maxHeight,maxWidth:e.maxWidth,visibility:"visible"};(e.fit===!0||e.cover===!0)&&(i.minWidth=n.width+"px",e.cover===!0&&(i.minHeight=n.height+"px")),Object.assign(e.el.style,i);const a=_s(e.el);let c=qn(n,a,e);if(e.absoluteOffset===void 0||e.offset===void 0)dr(c,n,a,e.anchorOrigin,e.selfOrigin);else{const{top:l,left:o}=c;dr(c,n,a,e.anchorOrigin,e.selfOrigin);let s=!1;if(c.top!==l){s=!0;const u=2*e.offset[1];n.center=n.top-=u,n.bottom-=u+2}if(c.left!==o){s=!0;const u=2*e.offset[0];n.middle=n.left-=u,n.right-=u+2}s===!0&&(c=qn(n,a,e),dr(c,n,a,e.anchorOrigin,e.selfOrigin))}i={top:c.top+"px",left:c.left+"px"},c.maxHeight!==void 0&&(i.maxHeight=c.maxHeight+"px",n.height>c.maxHeight&&(i.minHeight=i.maxHeight)),c.maxWidth!==void 0&&(i.maxWidth=c.maxWidth+"px",n.width>c.maxWidth&&(i.minWidth=i.maxWidth)),Object.assign(e.el.style,i),e.el.scrollTop!==t&&(e.el.scrollTop=t),e.el.scrollLeft!==r&&(e.el.scrollLeft=r)}function dr(e,r,t,n,i){const a=t.bottom,c=t.right,l=Pt(),o=window.innerHeight-l,s=document.body.clientWidth;if(e.top<0||e.top+a>o)if(i.vertical==="center")e.top=r[n.vertical]>o/2?Math.max(0,o-a):0,e.maxHeight=Math.min(a,o);else if(r[n.vertical]>o/2){const u=Math.min(o,n.vertical==="center"?r.center:n.vertical===i.vertical?r.bottom:r.top);e.maxHeight=Math.min(a,u),e.top=Math.max(0,u-a)}else e.top=Math.max(0,n.vertical==="center"?r.center:n.vertical===i.vertical?r.top:r.bottom),e.maxHeight=Math.min(a,o-e.top);if(e.left<0||e.left+c>s)if(e.maxWidth=Math.min(c,s),i.horizontal==="middle")e.left=r[n.horizontal]>s/2?Math.max(0,s-c):0;else if(r[n.horizontal]>s/2){const u=Math.min(s,n.horizontal==="middle"?r.middle:n.horizontal===i.horizontal?r.right:r.left);e.maxWidth=Math.min(c,u),e.left=Math.max(0,u-e.maxWidth)}else e.left=Math.max(0,n.horizontal==="middle"?r.middle:n.horizontal===i.horizontal?r.left:r.right),e.maxWidth=Math.min(c,s-e.left)}var la=K({name:"QMenu",inheritAttrs:!1,props:{...na,...Er,...ht,...Jn,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Gt},self:{type:String,validator:Gt},offset:{type:Array,validator:sa},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Or,"click","escapeKey"],setup(e,{slots:r,emit:t,attrs:n}){let i=null,a,c,l;const o=se(),{proxy:s}=o,{$q:u}=s,f=A(null),d=A(!1),p=b(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),h=vt(e,u),{registerTick:v,removeTick:k}=Yn(),{registerTimeout:g}=Dr(),{transitionProps:m,transitionStyle:P}=Xn(e),{localScrollTarget:S,changeScrollEvent:y,unconfigureScrollTarget:B}=aa(e,q),{anchorEl:x,canShow:z}=ia({showing:d}),{hide:N}=Mr({showing:d,canShow:z,handleShow:ce,handleHide:ge,hideOnRouteChange:p,processOnMount:!0}),{showPortal:O,hidePortal:U,renderPortal:ne}=Zn(o,f,Je,"menu"),Q={anchorEl:x,innerRef:f,onClickOutside(D){if(e.persistent!==!0&&d.value===!0)return N(D),(D.type==="touchstart"||D.target.classList.contains("q-dialog__backdrop"))&&Wt(D),!0}},W=b(()=>Vt(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),Z=b(()=>e.cover===!0?W.value:Vt(e.self||"top start",u.lang.rtl)),C=b(()=>(e.square===!0?" q-menu--square":"")+(h.value===!0?" q-menu--dark q-dark":"")),I=b(()=>e.autoClose===!0?{onClick:le}:{}),L=b(()=>d.value===!0&&e.persistent!==!0);j(L,D=>{D===!0?(Aa(ie),oa(Q)):(Qr(ie),Ht(Q))});function H(){Ma(()=>{let D=f.value;D&&D.contains(document.activeElement)!==!0&&(D=D.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||D.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||D.querySelector("[autofocus], [data-autofocus]")||D,D.focus({preventScroll:!0}))})}function ce(D){if(i=e.noRefocus===!1?document.activeElement:null,Ea(ee),O(),q(),a=void 0,D!==void 0&&(e.touchPosition||e.contextMenu)){const Oe=Bt(D);if(Oe.left!==void 0){const{top:Ye,left:Xe}=x.value.getBoundingClientRect();a={left:Oe.left-Xe,top:Oe.top-Ye}}}c===void 0&&(c=j(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,Pe)),e.noFocus!==!0&&document.activeElement.blur(),v(()=>{Pe(),e.noFocus!==!0&&H()}),g(()=>{u.platform.is.ios===!0&&(l=e.autoClose,f.value.click()),Pe(),O(!0),t("show",D)},e.transitionDuration)}function ge(D){k(),U(),ye(!0),i!==null&&(D===void 0||D.qClickOutside!==!0)&&(((D&&D.type.indexOf("key")===0?i.closest('[tabindex]:not([tabindex^="-"])'):void 0)||i).focus(),i=null),g(()=>{U(!0),t("hide",D)},e.transitionDuration)}function ye(D){a=void 0,c!==void 0&&(c(),c=void 0),(D===!0||d.value===!0)&&(Oa(ee),B(),Ht(Q),Qr(ie)),D!==!0&&(i=null)}function q(){(x.value!==null||e.scrollTarget!==void 0)&&(S.value=Qt(x.value,e.scrollTarget),y(S.value,Pe))}function le(D){l!==!0?(Da(s,D),t("click",D)):l=!1}function ee(D){L.value===!0&&e.noFocus!==!0&&Ia(f.value,D.target)!==!0&&H()}function ie(D){t("escapeKey"),N(D)}function Pe(){const D=f.value;D===null||x.value===null||ca({el:D,offset:e.offset,anchorEl:x.value,anchorOrigin:W.value,selfOrigin:Z.value,absoluteOffset:a,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Je(){return M(ei,m.value,()=>d.value===!0?M("div",{role:"menu",...n,ref:f,tabindex:-1,class:["q-menu q-position-engine scroll"+C.value,n.class],style:[n.style,P.value],...I.value},Te(r.default)):null)}return de(ye),Object.assign(s,{focus:H,updatePosition:Pe}),ne}}),pr=K({name:"QTooltip",inheritAttrs:!1,props:{...na,...Er,...Jn,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Gt},self:{type:String,default:"top middle",validator:Gt},offset:{type:Array,default:()=>[14,14],validator:sa},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Or],setup(e,{slots:r,emit:t,attrs:n}){let i,a;const c=se(),{proxy:{$q:l}}=c,o=A(null),s=A(!1),u=b(()=>Vt(e.anchor,l.lang.rtl)),f=b(()=>Vt(e.self,l.lang.rtl)),d=b(()=>e.persistent!==!0),{registerTick:p,removeTick:h}=Yn(),{registerTimeout:v}=Dr(),{transitionProps:k,transitionStyle:g}=Xn(e),{localScrollTarget:m,changeScrollEvent:P,unconfigureScrollTarget:S}=aa(e,ce),{anchorEl:y,canShow:B,anchorEvents:x}=ia({showing:s,configureAnchorEl:H}),{show:z,hide:N}=Mr({showing:s,canShow:B,handleShow:Q,handleHide:W,hideOnRouteChange:d,processOnMount:!0});Object.assign(x,{delayShow:I,delayHide:L});const{showPortal:O,hidePortal:U,renderPortal:ne}=Zn(c,o,ye,"tooltip");if(l.platform.is.mobile===!0){const q={anchorEl:y,innerRef:o,onClickOutside(ee){return N(ee),ee.target.classList.contains("q-dialog__backdrop")&&Wt(ee),!0}},le=b(()=>e.modelValue===null&&e.persistent!==!0&&s.value===!0);j(le,ee=>{(ee===!0?oa:Ht)(q)}),de(()=>{Ht(q)})}function Q(q){O(),p(()=>{a=new MutationObserver(()=>C()),a.observe(o.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),C(),ce()}),i===void 0&&(i=j(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,C)),v(()=>{O(!0),t("show",q)},e.transitionDuration)}function W(q){h(),U(),Z(),v(()=>{U(!0),t("hide",q)},e.transitionDuration)}function Z(){a!==void 0&&(a.disconnect(),a=void 0),i!==void 0&&(i(),i=void 0),S(),Ge(x,"tooltipTemp")}function C(){const q=o.value;y.value===null||!q||ca({el:q,offset:e.offset,anchorEl:y.value,anchorOrigin:u.value,selfOrigin:f.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function I(q){if(l.platform.is.mobile===!0){Lt(),document.body.classList.add("non-selectable");const le=y.value,ee=["touchmove","touchcancel","touchend","click"].map(ie=>[le,ie,"delayHide","passiveCapture"]);Ie(x,"tooltipTemp",ee)}v(()=>{z(q)},e.delay)}function L(q){l.platform.is.mobile===!0&&(Ge(x,"tooltipTemp"),Lt(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),v(()=>{N(q)},e.hideDelay)}function H(){if(e.noParentEvent===!0||y.value===null)return;const q=l.platform.is.mobile===!0?[[y.value,"touchstart","delayShow","passive"]]:[[y.value,"mouseenter","delayShow","passive"],[y.value,"mouseleave","delayHide","passive"]];Ie(x,"anchor",q)}function ce(){if(y.value!==null||e.scrollTarget!==void 0){m.value=Qt(y.value,e.scrollTarget);const q=e.noParentEvent===!0?C:N;P(m.value,q)}}function ge(){return s.value===!0?M("div",{...n,ref:o,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,g.value],role:"tooltip"},Te(r.default)):null}function ye(){return M(ei,k.value,ge)}return de(Z),Object.assign(c.proxy,{updatePosition:C}),ne}}),Cs=K({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:r}){const t=b(()=>{const n=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(i=>e[i]===!0).map(i=>`q-btn-group--${i}`).join(" ");return`q-btn-group row no-wrap${n.length>0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>M("div",{class:t.value},Te(r.default))}});const Ss={key:0,class:"text-grey row items-center"},Ts={key:1,class:"text-primary row items-center"},ks={key:2,class:"text-negative row items-center"},Ps={key:3,class:"text-positive row items-center"},xs={key:4,class:"text-primary row items-center"},Rs={key:5,class:"text-grey"},Es=Ke({__name:"FriendList",setup(e){return(r,t)=>(G(),ve(Vi,{style:{height:"calc(100% - 100px)"}},{default:E(()=>[T(Pr,null,{default:E(()=>[T(Ba,{"enter-active-class":"animated lightSpeedInRight","leave-active-class":"animated lightSpeedOutRight"},{default:E(()=>[(G(!0),Ce(Wn,null,Vn(be(Fe),n=>(G(),ve(Ae,{key:n.id,class:wa({"animated pulse highlight":n.highlight})},{default:E(()=>[T(he,{avatar:""},{default:E(()=>[T(ti,null,{default:E(()=>[T(Ur,{hash:n.id},null,8,["hash"])]),_:2},1024)]),_:2},1024),T(he,null,{default:E(()=>[T(ft,{lines:"1",style:{"text-overflow":"ellipsis",width:"5em"}},{default:E(()=>[ae(wt(n.username),1)]),_:2},1024),T(ft,{caption:""},{default:E(()=>[n.status==="outgoing friend request"?(G(),Ce("div",Ss," Pending ")):n.status==="incoming friend request"?(G(),Ce("div",Ts," Friend Request ")):n.verification==="untrusted"?(G(),Ce("div",ks,[T(nt,{name:"no_encryption",class:"q-mr-xs"}),ae(" Authentication failed ")])):n.connected&&n.verification==="verified"?(G(),Ce("div",Ps,[T(nt,{name:"verified",class:"q-mr-xs"}),ae(" Connected ")])):n.connected&&n.verification==="pending"?(G(),Ce("div",xs,[T(nt,{name:"pending",class:"q-mr-xs"}),ae(" Checking ")])):(G(),Ce("div",Rs,"Not connected"))]),_:2},1024)]),_:2},1024),n.status==="friend"?(G(),ve(he,{key:0,side:""},{default:E(()=>[T(nt,{name:"keyboard_arrow_down",style:{cursor:"pointer"}}),T(la,{"auto-close":"",offset:[-18,-8]},{default:E(()=>[T(Pr,{style:{"min-width":"150px"}},{default:E(()=>[T(Ae,{clickable:""},{default:E(()=>[T(he,null,{default:E(()=>[ae("Edit Name")]),_:1})]),_:1}),T(Ae,{clickable:"",onClick:i=>r.$navigator.clipboard.writeText(n.id)},{default:E(()=>[T(he,null,{default:E(()=>[ae("Copy peer ID")]),_:1})]),_:2},1032,["onClick"]),T(La,{class:"q-my-xs"}),T(Ae,{clickable:""},{default:E(()=>[T(he,{onClick:i=>n.remove()},{default:E(()=>[ae("Remove")]),_:2},1032,["onClick"])]),_:2},1024),T(Ae,null,{default:E(()=>[T(he,null,{default:E(()=>[ae(wt(n.connection?.connectionId),1)]),_:2},1024)]),_:2},1024),T(Ae,{clickable:"",onClick:i=>n.connection.send("Hello")},{default:E(()=>[T(he,null,{default:E(()=>[ae("Send Hello")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):n.status==="incoming friend request"?(G(),ve(he,{key:1,side:""},{default:E(()=>[T(Cs,{push:""},{default:E(()=>[T(Se,{push:"",size:"sm",color:"positive",icon:"done",onClick:i=>n.acceptFriendRequest()},{default:E(()=>[T(pr,null,{default:E(()=>[ae("Accpet")]),_:1})]),_:2},1032,["onClick"]),T(Se,{dense:"",push:"",size:"sm",color:"negative",icon:"close",onClick:i=>n.remove()},{default:E(()=>[T(pr,null,{default:E(()=>[ae("Decline")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):n.status==="outgoing friend request"?(G(),ve(he,{key:2,side:""},{default:E(()=>[T(Se,{flat:"",size:"sm",color:"grey",icon:"cancel",onClick:i=>n.remove()},{default:E(()=>[T(pr,null,{default:E(()=>[ae("Cancel")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):ri("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1}))}});var Os=ni(Es,[["__scopeId","data-v-3389c46d"]]),Ds=K({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:r,emit:t}){const{proxy:{$q:n}}=se(),i=Kt(mt,me);if(i===me)return console.error("QHeader needs to be child of QLayout"),me;const a=A(parseInt(e.heightHint,10)),c=A(!0),l=b(()=>e.reveal===!0||i.view.value.indexOf("H")>-1||n.platform.is.ios&&i.isContainer.value===!0),o=b(()=>{if(e.modelValue!==!0)return 0;if(l.value===!0)return c.value===!0?a.value:0;const m=a.value-i.scroll.value.position;return m>0?m:0}),s=b(()=>e.modelValue!==!0||l.value===!0&&c.value!==!0),u=b(()=>e.modelValue===!0&&s.value===!0&&e.reveal===!0),f=b(()=>"q-header q-layout__section--marginal "+(l.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(s.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),d=b(()=>{const m=i.rows.value.top,P={};return m[0]==="l"&&i.left.space===!0&&(P[n.lang.rtl===!0?"right":"left"]=`${i.left.size}px`),m[2]==="r"&&i.right.space===!0&&(P[n.lang.rtl===!0?"left":"right"]=`${i.right.size}px`),P});function p(m,P){i.update("header",m,P)}function h(m,P){m.value!==P&&(m.value=P)}function v({height:m}){h(a,m),p("size",m)}function k(m){u.value===!0&&h(c,!0),t("focusin",m)}j(()=>e.modelValue,m=>{p("space",m),h(c,!0),i.animate()}),j(o,m=>{p("offset",m)}),j(()=>e.reveal,m=>{m===!1&&h(c,e.modelValue)}),j(c,m=>{i.animate(),t("reveal",m)}),j(i.scroll,m=>{e.reveal===!0&&h(c,m.direction==="up"||m.position<=e.revealOffset||m.position-m.inflectionPoint<100)});const g={};return i.instances.header=g,e.modelValue===!0&&p("size",a.value),p("space",e.modelValue),p("offset",o.value),de(()=>{i.instances.header===g&&(i.instances.header=void 0,p("size",0),p("offset",0),p("space",!1))}),()=>{const m=Br(r.default,[]);return e.elevated===!0&&m.push(M("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),m.push(M(We,{debounce:0,onResize:v})),M("header",{class:f.value,style:d.value,onFocusin:k},m)}}});function Ms(e){navigator.clipboard.writeText(e),ja.create({message:"Copied to Clipboard",icon:"inventory",position:"top",timeout:500})}const As={class:"text-subtitle1 q-mr-sm user-select-none"},Is=Ke({__name:"MeHeader",emits:["toggle-left-drawer"],setup(e){const r=`4d8638e965f9da624e5b0f47fc10cae7d545392d
`;return(t,n)=>(G(),ve(Ds,{elevated:""},{default:E(()=>[T(xt,null,{default:E(()=>[T(Se,{round:"",flat:"",icon:"keyboard_arrow_left",class:"WAL__drawer-open q-mr-sm",onClick:n[0]||(n[0]=i=>t.$emit("toggle-left-drawer"))}),be(Jr)?(G(),ve(Se,{key:1,flat:"",label:"Stop Screenshare",icon:"stop_screen_share",class:"text-grey-4",onClick:n[1]||(n[1]=i=>Jr.value=void 0)})):(G(),ve(Se,{key:0,flat:"",label:"Start Screenshare",icon:"screen_share",class:"text-grey-4",onClick:be(Ua)},null,8,["onClick"])),T(ii),Ve("div",As,wt(be(Yt)),1),T(ti,{class:"q-mr-xs"},{default:E(()=>[T(Ur,{hash:be(kr)},null,8,["hash"])]),_:1}),T(Se,{icon:"more_vert",ripple:!1,dense:"",round:"",flat:""},{default:E(()=>[T(la,{"auto-close":"",offset:[110,0]},{default:E(()=>[T(Pr,{separator:"",style:{"min-width":"150px"}},{default:E(()=>[T(Ae,{clickable:"",onClick:n[2]||(n[2]=i=>be(Ms)(be(kr)))},{default:E(()=>[T(he,null,{default:E(()=>[T(ft,null,{default:E(()=>[ae("Copy own peer ID ")]),_:1})]),_:1})]),_:1}),be(r)?(G(),ve(Ae,{key:0,onClick:n[3]||(n[3]=za(()=>{},["prevent"]))},{default:E(()=>[T(he,{style:{width:"200px"}},{default:E(()=>[T(ft,null,{default:E(()=>[ae("Commit")]),_:1}),T(ft,{caption:"",class:"ellipsis text-grey"},{default:E(()=>[ae(wt(be(r)),1)]),_:1})]),_:1})]),_:1})):ri("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var Bs=ni(Is,[["__scopeId","data-v-094808c7"]]);const ws=Ve("div",{class:"text-h6",style:{"font-family":"sans-serif","user-select":"none"}}," W\u039BVE ",-1),Fs=Ke({__name:"MainLayout",setup(e){const r=Fa(),t=A(!1),n=A(""),i=b(()=>({height:r.screen.height+"px"}));function a(){t.value=!t.value}return(c,l)=>{const o=qa("router-view");return G(),Ce("div",{class:"WAL position-relative",style:$a(be(i))},[T(Xa,{view:"lHh Lpr lFf",class:"WAL__layout shadow-3",container:""},{default:E(()=>[T(Bs,{onToggleLeftDrawer:a,class:"bg-dark-alt-2"}),T(Wa,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=s=>t.value=s),"show-if-above":"",breakpoint:690},{default:E(()=>[T(xt,null,{default:E(()=>[ws,T(ii),T(Se,{round:"",flat:"",icon:"close",class:"WAL__drawer-close",onClick:a})]),_:1}),T(xt,null,{default:E(()=>[T(gs)]),_:1}),T(Os)]),_:1},8,["modelValue"]),T(Ka,{class:"dark-transparent"},{default:E(()=>[T(o)]),_:1}),T(Ja,null,{default:E(()=>[T(xt,{class:"row bg-dark-alt"},{default:E(()=>[T(Se,{round:"",flat:"",icon:"insert_emoticon",class:"q-mr-sm"}),T(wr,{rounded:"",outlined:"",dense:"",class:"WAL__field col-grow q-mr-sm",modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value=s),placeholder:"Type a message"},null,8,["modelValue"]),T(Se,{round:"",flat:"",icon:"mic"})]),_:1})]),_:1})]),_:1})],4)}}});export{Fs as default};
